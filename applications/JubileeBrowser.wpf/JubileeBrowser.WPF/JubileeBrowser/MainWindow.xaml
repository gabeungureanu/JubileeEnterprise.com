<Window x:Class="JubileeBrowser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns:local="clr-namespace:JubileeBrowser"
        xmlns:controls="clr-namespace:JubileeBrowser.Controls"
        mc:Ignorable="d"
        Title="Jubilee Browser"
        Height="800" Width="1280"
        MinHeight="400" MinWidth="600"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="False"
        Background="#000000"
        WindowStartupLocation="Manual"
        SizeToContent="Manual"
        Loaded="Window_Loaded"
        Closing="Window_Closing"
        StateChanged="Window_StateChanged"
        LocationChanged="Window_LocationChanged"
        SizeChanged="Window_SizeChanged"
        KeyDown="Window_KeyDown"
        PreviewMouseWheel="Window_PreviewMouseWheel">

    <Window.Resources>
        <!-- Color Definitions matching Electron app -->
        <Color x:Key="BgPrimaryColor">#000000</Color>
        <Color x:Key="BgSecondaryColor">#16213e</Color>
        <Color x:Key="BgTertiaryColor">#0f3460</Color>
        <Color x:Key="AccentColor">#e94560</Color>
        <Color x:Key="JubileeAccentColor">#E6AC00</Color>
        <Color x:Key="TextPrimaryColor">#ffffff</Color>
        <Color x:Key="TextSecondaryColor">#a0a0a0</Color>
        <Color x:Key="BorderColor">#2a2a4e</Color>

        <SolidColorBrush x:Key="BgPrimaryBrush" Color="{StaticResource BgPrimaryColor}"/>
        <SolidColorBrush x:Key="BgSecondaryBrush" Color="{StaticResource BgSecondaryColor}"/>
        <SolidColorBrush x:Key="BgTertiaryBrush" Color="{StaticResource BgTertiaryColor}"/>
        <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}"/>
        <SolidColorBrush x:Key="JubileeAccentBrush" Color="{StaticResource JubileeAccentColor}"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource TextPrimaryColor}"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="{StaticResource TextSecondaryColor}"/>
        <SolidColorBrush x:Key="BorderBrush" Color="{StaticResource BorderColor}"/>

        <!-- Custom Scrollbar Style for Menu -->
        <Style x:Key="MenuScrollBarThumb" TargetType="Thumb">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Thumb">
                        <Border Background="#FFD700" CornerRadius="3" Margin="1"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MenuScrollBarStyle" TargetType="ScrollBar">
            <Setter Property="Width" Value="8"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="#1a1a2e">
                            <Track x:Name="PART_Track" IsDirectionReversed="True">
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource MenuScrollBarThumb}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MenuScrollViewerStyle" TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ScrollContentPresenter Grid.Column="0"/>
                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                       Grid.Column="1"
                                       Style="{StaticResource MenuScrollBarStyle}"
                                       Value="{TemplateBinding VerticalOffset}"
                                       Maximum="{TemplateBinding ScrollableHeight}"
                                       ViewportSize="{TemplateBinding ViewportHeight}"
                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Bookmark Button Style (no hover effect) -->
        <Style x:Key="BookmarkButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="24"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="Transparent" Padding="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Button Style -->
        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4a4a6e"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Window Control Button Style -->
        <Style x:Key="WindowButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonStyle}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#e81123"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Tab Context Menu Style -->
        <Style x:Key="TabContextMenuStyle" TargetType="ContextMenu">
            <Setter Property="Background" Value="#1e1e2e"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ContextMenu">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="True">
                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Menu Item Style -->
        <Style x:Key="TabContextMenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                CornerRadius="4"
                                Margin="2,1"
                                Padding="{TemplateBinding Padding}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="icon"
                                          Grid.Column="0"
                                          Text="{TemplateBinding Tag}"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="12"
                                          VerticalAlignment="Center"
                                          Foreground="{TemplateBinding Foreground}"/>
                                <ContentPresenter Grid.Column="1"
                                                 ContentSource="Header"
                                                 VerticalAlignment="Center"
                                                 Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2"
                                          Text="{TemplateBinding InputGestureText}"
                                          Foreground="#808080"
                                          FontSize="11"
                                          VerticalAlignment="Center"
                                          Margin="20,0,0,0"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Submenu Item Style -->
        <Style x:Key="TabContextSubMenuItemStyle" TargetType="MenuItem" BasedOn="{StaticResource TabContextMenuItemStyle}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                CornerRadius="4"
                                Margin="2,1"
                                Padding="{TemplateBinding Padding}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="icon"
                                          Grid.Column="0"
                                          Text="{TemplateBinding Tag}"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="12"
                                          VerticalAlignment="Center"
                                          Foreground="{TemplateBinding Foreground}"/>
                                <ContentPresenter Grid.Column="1"
                                                 ContentSource="Header"
                                                 VerticalAlignment="Center"
                                                 Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2"
                                          Text="&#xE76C;"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="10"
                                          VerticalAlignment="Center"
                                          Foreground="#808080"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Menu Separator Style -->
        <Style x:Key="TabContextMenuSeparatorStyle" TargetType="Separator">
            <Setter Property="Background" Value="#3a3a5e"/>
            <Setter Property="Margin" Value="8,4"/>
            <Setter Property="Height" Value="1"/>
        </Style>

        <!-- Tab Context Menu -->
        <ContextMenu x:Key="TabContextMenu" Style="{StaticResource TabContextMenuStyle}">
            <!-- New Tab Section -->
            <MenuItem Header="New tab" Tag="&#xE710;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="Ctrl+T" Click="ContextMenu_NewTab_Click"/>
            <MenuItem Header="New window" Tag="&#xE8A7;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="Ctrl+N" Click="ContextMenu_NewWindow_Click"/>
            <MenuItem Header="New WWBW window" Tag="&#xE72E;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="Ctrl+Shift+N" Click="ContextMenu_NewWWBWWindow_Click"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Tab Management Section -->
            <MenuItem Header="Add tab to the right" Tag="&#xE8A4;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_AddTabToRight_Click"/>
            <MenuItem Header="Add tab to new group" Tag="&#xE8F1;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_AddTabToNewGroup_Click"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Navigation Section -->
            <MenuItem Header="Refresh" Tag="&#xE72C;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="F5" Click="ContextMenu_Refresh_Click"/>
            <MenuItem Header="Duplicate tab" Tag="&#xE8C8;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_DuplicateTab_Click"/>
            <MenuItem x:Name="MoveTabToMenuItem" Header="Move tab to" Tag="&#xE8AB;" Style="{StaticResource TabContextSubMenuItemStyle}">
                <MenuItem Header="New window" Tag="&#xE8A7;" Style="{StaticResource TabContextMenuItemStyle}"
                         Click="ContextMenu_MoveTabToNewWindow_Click"/>
            </MenuItem>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Pin/Mute Section -->
            <MenuItem x:Name="PinTabMenuItem" Header="Pin tab" Tag="&#xE718;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_PinTab_Click"/>
            <MenuItem x:Name="MuteTabMenuItem" Header="Mute tab" Tag="&#xE74F;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_MuteTab_Click"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Send/Sync Section -->
            <MenuItem Header="Send tab to your devices" Tag="&#xE836;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_SendTabToDevice_Click" IsEnabled="False"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Close Section -->
            <MenuItem Header="Close tab" Tag="&#xE711;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="Ctrl+W" Click="ContextMenu_CloseTab_Click"/>
            <MenuItem Header="Close other tabs" Tag="&#xEA99;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_CloseOtherTabs_Click"/>
            <MenuItem Header="Close tabs to the right" Tag="&#xE76C;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_CloseTabsToRight_Click"/>
            <MenuItem x:Name="ReopenClosedTabMenuItem" Header="Reopen closed tab" Tag="&#xE7A7;" Style="{StaticResource TabContextMenuItemStyle}"
                     InputGestureText="Ctrl+Shift+T" Click="ContextMenu_ReopenClosedTab_Click"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- Layout Section -->
            <MenuItem x:Name="VerticalTabsMenuItem" Header="Turn on vertical tabs" Tag="&#xE745;" Style="{StaticResource TabContextMenuItemStyle}"
                     Click="ContextMenu_ToggleVerticalTabs_Click"/>

            <Separator Style="{StaticResource TabContextMenuSeparatorStyle}"/>

            <!-- More Tools Section -->
            <MenuItem Header="More tools" Tag="&#xE712;" Style="{StaticResource TabContextSubMenuItemStyle}">
                <MenuItem Header="Extensions" Tag="&#xEA86;" Style="{StaticResource TabContextMenuItemStyle}"
                         Click="ContextMenu_Extensions_Click"/>
                <MenuItem Header="Browser task manager" Tag="&#xE9D9;" Style="{StaticResource TabContextMenuItemStyle}"
                         InputGestureText="Shift+Esc" Click="ContextMenu_TaskManager_Click"/>
                <MenuItem Header="Developer tools" Tag="&#xE943;" Style="{StaticResource TabContextMenuItemStyle}"
                         InputGestureText="F12" Click="ContextMenu_DevTools_Click"/>
                <MenuItem Header="Web capture" Tag="&#xE924;" Style="{StaticResource TabContextMenuItemStyle}"
                         InputGestureText="Ctrl+Shift+S" Click="ContextMenu_WebCapture_Click"/>
                <MenuItem x:Name="ContextMenuMobileView" Header="Toggle mobile view" Tag="&#xE1C9;" Style="{StaticResource TabContextMenuItemStyle}"
                         InputGestureText="Ctrl+Shift+M" Click="ContextMenu_MobileView_Click"/>
            </MenuItem>
        </ContextMenu>

        <!-- Main Menu Popup Styles -->
        <Style x:Key="MainMenuItemStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="4"
                                Margin="4,1">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4a4a6e"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MainMenuExpanderStyle" TargetType="Button" BasedOn="{StaticResource MainMenuItemStyle}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="4"
                                Margin="4,1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0"
                                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1"
                                          Text="&#xE76C;"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="10"
                                          Foreground="#808080"
                                          VerticalAlignment="Center"
                                          Margin="8,0,0,0"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MainMenuSeparatorStyle" TargetType="Border">
            <Setter Property="Background" Value="#3a3a5e"/>
            <Setter Property="Height" Value="1"/>
            <Setter Property="Margin" Value="16,6"/>
        </Style>

        <!-- Storyboard for menu slide-in animation -->
        <Storyboard x:Key="MainMenuSlideIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.15"/>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                           From="-10" To="0" Duration="0:0:0.15">
                <DoubleAnimation.EasingFunction>
                    <QuadraticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="MainMenuSlideOut">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1" To="0" Duration="0:0:0.1"/>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                           From="0" To="-10" Duration="0:0:0.1"/>
        </Storyboard>

        <!-- Profile Button Style -->
        <Style x:Key="ProfileButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="16"
                                Padding="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4a4a6e"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Custom Tooltip Style with Blue Accent Bar -->
        <Style x:Key="NavBarTooltipStyle" TargetType="ToolTip">
            <Setter Property="Background" Value="Black"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Placement" Value="Left"/>
            <Setter Property="HorizontalOffset" Value="-8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToolTip">
                        <Border Background="Black" CornerRadius="4" Padding="0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="3"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <!-- Blue accent bar on left -->
                                <Border Grid.Column="0" Background="#0f3460" CornerRadius="4,0,0,4"/>
                                <!-- Tooltip content -->
                                <TextBlock Grid.Column="1"
                                          Text="{TemplateBinding Content}"
                                          Foreground="White"
                                          FontSize="12"
                                          Padding="10,6,12,6"
                                          VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Profile Popup Link Button Style -->
        <Style x:Key="ProfileLinkButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#60a5fa"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <TextBlock x:Name="text"
                                  Text="{TemplateBinding Content}"
                                  Foreground="{TemplateBinding Foreground}"
                                  TextDecorations="Underline"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="text" Property="Foreground" Value="#93c5fd"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Tab Item Style -->
        <Style x:Key="BrowserTabStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="MaxWidth" Value="240"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="Opacity" Value="0.5"/>
            <Setter Property="Panel.ZIndex" Value="0"/>
            <Setter Property="ContextMenu" Value="{StaticResource TabContextMenu}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="1"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="border"
                                    Grid.Column="0"
                                    Background="{TemplateBinding Background}"
                                    CornerRadius="6,6,0,0"
                                    Padding="8,0">
                                <Grid Margin="0,-2,0,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="16"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="24"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid Grid.Column="0" Width="16" Height="16" VerticalAlignment="Center">
                                        <!-- Favicon from website (hidden when no favicon) -->
                                        <Image x:Name="tabFavicon"
                                               Source="{Binding Favicon}"
                                               Width="16" Height="16">
                                            <Image.Style>
                                                <Style TargetType="Image">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Favicon}" Value="{x:Null}">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Favicon}" Value="">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Image.Style>
                                        </Image>
                                        <!-- Default WWBW icon for active WWBW tabs when no favicon (black, smaller) -->
                                        <Image x:Name="tabDefaultWWBWIconActive"
                                               Source="Resources/Icons/wwbw-black.png"
                                               Width="14" Height="14"
                                               Visibility="Collapsed"/>
                                        <!-- Default WWBW icon for inactive WWBW tabs when no favicon (white) -->
                                        <Image x:Name="tabDefaultWWBWIconInactive"
                                               Source="Resources/Icons/wwbw-white.png"
                                               Width="14" Height="14"
                                               Visibility="Collapsed"/>
                                        <!-- Default WWBW icon for WWW tabs with inspire:// URLs when no favicon (white, 14px to match yellow tabs) -->
                                        <Image x:Name="tabDefaultInspireIcon"
                                               Source="Resources/Icons/wwbw-white.png"
                                               Width="14" Height="14"
                                               Visibility="Collapsed"/>
                                    </Grid>
                                    <TextBlock x:Name="titleText" Grid.Column="1"
                                              Text="{Binding Title}"
                                              VerticalAlignment="Center"
                                              Margin="8,0"
                                              TextTrimming="CharacterEllipsis"
                                              FontWeight="Normal"
                                              Foreground="{TemplateBinding Foreground}"/>
                                    <Button x:Name="closeBtn" Grid.Column="2"
                                            Style="{StaticResource NavButtonStyle}"
                                            Width="18" Height="18"
                                            Click="TabCloseButton_Click"
                                            Tag="{Binding Id}">
                                        <TextBlock x:Name="closeBtnIcon" Text="&#xE711;" FontFamily="Segoe MDL2 Assets" FontSize="9" Foreground="White"/>
                                    </Button>
                                </Grid>
                            </Border>
                            <!-- Tab Divider -->
                            <Border x:Name="divider" Grid.Column="1" Width="1"
                                    Background="#3a3a5e" VerticalAlignment="Stretch"
                                    Margin="0,6,0,6"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <!-- Active WWBW tab: Yellow background to match nav bar, black text, full opacity -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="border" Property="Background" Value="#FFD700"/>
                                <Setter TargetName="titleText" Property="Foreground" Value="#1a1a2e"/>
                                <Setter TargetName="titleText" Property="FontWeight" Value="Bold"/>
                                <Setter TargetName="divider" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="closeBtnIcon" Property="Foreground" Value="#1a1a2e"/>
                                <Setter Property="Opacity" Value="1.0"/>
                                <Setter Property="Panel.ZIndex" Value="10"/>
                            </MultiDataTrigger>
                            <!-- Hover on close button for active WWBW tab: Yellow X -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True"/>
                                    <Condition Binding="{Binding ElementName=closeBtn, Path=IsMouseOver}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="closeBtnIcon" Property="Foreground" Value="#FFD700"/>
                                <Setter TargetName="closeBtnIcon" Property="FontWeight" Value="Bold"/>
                            </MultiDataTrigger>
                            <!-- Active WWW tab: Blue background to match nav bar, white text, full opacity -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="Internet"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="border" Property="Background" Value="#0099FF"/>
                                <Setter TargetName="titleText" Property="Foreground" Value="White"/>
                                <Setter TargetName="titleText" Property="FontWeight" Value="Bold"/>
                                <Setter TargetName="divider" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="closeBtnIcon" Property="Foreground" Value="White"/>
                                <Setter Property="Opacity" Value="1.0"/>
                                <Setter Property="Panel.ZIndex" Value="10"/>
                            </MultiDataTrigger>
                            <!-- Inactive WWBW tabs: Gold/yellow background at 50% opacity, white text full opacity -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="False"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="border" Property="Background" Value="#80E6AC00"/>
                                <Setter TargetName="titleText" Property="Foreground" Value="White"/>
                                <Setter TargetName="closeBtnIcon" Property="Foreground" Value="White"/>
                                <Setter TargetName="divider" Property="Background" Value="#80CC9900"/>
                                <Setter Property="Opacity" Value="1.0"/>
                            </MultiDataTrigger>
                            <!-- Inactive WWW tabs: Blue background at 50% opacity, white text full opacity -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="Internet"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="False"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="border" Property="Background" Value="#800099FF"/>
                                <Setter TargetName="titleText" Property="Foreground" Value="White"/>
                                <Setter TargetName="closeBtnIcon" Property="Foreground" Value="White"/>
                                <Setter Property="Opacity" Value="1.0"/>
                            </MultiDataTrigger>
                            <!-- Mouseover effect for inactive tabs - slightly brighter background -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsSelected" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                            </MultiTrigger>
                            <!-- Show black WWBW icon for ACTIVE WWBW tabs when no favicon -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True"/>
                                    <Condition Binding="{Binding Favicon}" Value="{x:Null}"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultWWBWIconActive" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True"/>
                                    <Condition Binding="{Binding Favicon}" Value=""/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultWWBWIconActive" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                            <!-- Show white WWBW icon for INACTIVE WWBW tabs when no favicon -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="False"/>
                                    <Condition Binding="{Binding Favicon}" Value="{x:Null}"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultWWBWIconInactive" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="JubileeBibles"/>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="False"/>
                                    <Condition Binding="{Binding Favicon}" Value=""/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultWWBWIconInactive" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                            <!-- Show white WWBW icon for WWW tabs with inspire:// URLs when no favicon (active) -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="Internet"/>
                                    <Condition Binding="{Binding IsInspireUrl}" Value="True"/>
                                    <Condition Binding="{Binding Favicon}" Value="{x:Null}"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultInspireIcon" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Mode}" Value="Internet"/>
                                    <Condition Binding="{Binding IsInspireUrl}" Value="True"/>
                                    <Condition Binding="{Binding Favicon}" Value=""/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="tabDefaultInspireIcon" Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Address Bar Style -->
        <Style x:Key="AddressBarStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="16"
                                BorderBrush="Transparent"
                                BorderThickness="0"
                                Padding="{TemplateBinding Padding}">
                            <ScrollViewer x:Name="PART_ContentHost"
                                         VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="Background" Value="#303050"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModeToggleButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="24"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Mode Radio Button Style for WWW -->
        <Style x:Key="ModeRadioWWWStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="MinWidth" Value="70"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border"
                                CornerRadius="4"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                Padding="6,4">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <!-- Radio circle -->
                                <Grid Width="18" Height="18" Margin="0,0,6,0">
                                    <Ellipse x:Name="outerCircle"
                                             Width="18" Height="18"
                                             Stroke="{TemplateBinding Foreground}"
                                             StrokeThickness="2"
                                             Fill="Transparent"/>
                                    <Ellipse x:Name="innerDot"
                                             Width="10" Height="10"
                                             Fill="{TemplateBinding Foreground}"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"
                                             Visibility="Collapsed"/>
                                </Grid>
                                <TextBlock x:Name="label"
                                          Text="WWW"
                                          FontSize="12"
                                          FontWeight="Bold"
                                          Foreground="{TemplateBinding Foreground}"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="innerDot" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="innerDot" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="label" Property="Foreground" Value="Black"/>
                                <Setter TargetName="outerCircle" Property="Stroke" Value="Black"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Mode Radio Button Style for WWBW -->
        <Style x:Key="ModeRadioWWBWStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border"
                                CornerRadius="4"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                Padding="6,4">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <!-- Radio circle -->
                                <Grid Width="18" Height="18" Margin="0,0,6,0">
                                    <Ellipse x:Name="outerCircle"
                                             Width="18" Height="18"
                                             Stroke="{TemplateBinding Foreground}"
                                             StrokeThickness="2"
                                             Fill="Transparent"/>
                                    <Ellipse x:Name="innerDot"
                                             Width="10" Height="10"
                                             Fill="{TemplateBinding Foreground}"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"
                                             Visibility="Collapsed"/>
                                </Grid>
                                <TextBlock x:Name="label"
                                          Text="WWBW"
                                          FontSize="12"
                                          FontWeight="Bold"
                                          Foreground="{TemplateBinding Foreground}"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="innerDot" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter TargetName="innerDot" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="label" Property="Foreground" Value="White"/>
                                <Setter TargetName="outerCircle" Property="Stroke" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Background="Black">
        <Grid.RowDefinitions>
            <!-- Title Bar with Tabs: 36px -->
            <RowDefinition x:Name="TitleBarRow" Height="36"/>
            <!-- Navigation Bar: 38px -->
            <RowDefinition x:Name="NavBarRow" Height="38"/>
            <!-- Favorites Bar: 0 initially, expands to 40px -->
            <RowDefinition x:Name="FavoritesBarRow" Height="0"/>
            <!-- Content Area -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Title Bar with Tabs -->
        <Grid x:Name="TitleBar" Grid.Row="0" Background="Black" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Grid.ColumnDefinitions>
                <!-- Tabs Area with New Tab Button -->
                <ColumnDefinition Width="*"/>
                <!-- Window Controls -->
                <ColumnDefinition Width="138"/>
            </Grid.ColumnDefinitions>

            <!-- Tab Strip with Jubilee Logo and New Tab Button -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,0" VerticalAlignment="Bottom">
                <!-- Jubilee Profile Logo (50% reduced size) -->
                <Border x:Name="JubileeLogoButton"
                        Background="Transparent"
                        Width="18" Height="18"
                        Margin="6,-3,4,0"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        ToolTip="Jubilee Favorites"
                        MouseLeftButtonDown="JubileeLogoButton_Click">
                    <Grid>
                        <!-- Outer glow ring -->
                        <Ellipse Width="15" Height="15" StrokeThickness="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Ellipse.Stroke>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#E6AC00" Offset="0"/>
                                    <GradientStop Color="#FFD700" Offset="0.5"/>
                                    <GradientStop Color="#E6AC00" Offset="1"/>
                                </LinearGradientBrush>
                            </Ellipse.Stroke>
                        </Ellipse>
                        <!-- Inner circle with J -->
                        <Ellipse Width="12" Height="12" Fill="#1a1a2e" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        <TextBlock Text="J"
                                   FontFamily="Georgia"
                                   FontSize="7"
                                   FontWeight="Bold"
                                   Foreground="#E6AC00"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>
                <ListBox x:Name="TabStrip"
                         VerticalAlignment="Bottom"
                         Background="Transparent"
                         BorderThickness="0"
                         ItemContainerStyle="{StaticResource BrowserTabStyle}"
                         SelectionChanged="TabStrip_SelectionChanged"
                         AllowDrop="True"
                         PreviewMouseLeftButtonDown="TabStrip_PreviewMouseLeftButtonDown"
                         PreviewMouseMove="TabStrip_PreviewMouseMove"
                         Drop="TabStrip_Drop"
                         DragOver="TabStrip_DragOver"
                         ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                         ScrollViewer.VerticalScrollBarVisibility="Disabled">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                </ListBox>

                <!-- New Tab Button - styled as a permanent black tab -->
                <Border x:Name="NewTabButton"
                        Background="#000000"
                        CornerRadius="6,6,0,0"
                        Height="32"
                        MinWidth="40"
                        Margin="2,0,0,0"
                        VerticalAlignment="Bottom"
                        Cursor="Hand"
                        ToolTip="New Tab (Ctrl+T)"
                        MouseLeftButtonDown="NewTabButton_Click">
                    <TextBlock Text="+"
                               FontSize="20"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Margin="10,0,10,15">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="White"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Foreground" Value="#FFD700"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Border>
            </StackPanel>

            <!-- Window Controls -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,-5,0,0">
                <Button x:Name="MinimizeButton"
                        Style="{StaticResource WindowButtonStyle}"
                        Click="MinimizeButton_Click"
                        Content="&#xE921;"/>
                <Button x:Name="MaximizeButton"
                        Style="{StaticResource WindowButtonStyle}"
                        Click="MaximizeButton_Click"
                        Content="&#xE922;"/>
                <Button x:Name="CloseButton"
                        Style="{StaticResource CloseButtonStyle}"
                        Click="CloseButton_Click"
                        Content="&#xE8BB;"/>
            </StackPanel>
        </Grid>

        <!-- Navigation Bar - spans into title bar row to eliminate line -->
        <Grid x:Name="NavigationBar" Grid.Row="1" Background="{StaticResource BgSecondaryBrush}" Margin="0,-8,0,0" Panel.ZIndex="10">
            <Grid.ColumnDefinitions>
                <!-- Navigation Buttons -->
                <ColumnDefinition Width="Auto"/>
                <!-- Address Bar -->
                <ColumnDefinition Width="*"/>
                <!-- Mode Switch Button -->
                <ColumnDefinition Width="Auto"/>
                <!-- Right Actions -->
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Navigation Buttons -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="12,0,8,0">
                <Button x:Name="BackButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="BackButton_Click"
                        IsEnabled="False"
                        ToolTip="Back (Alt+Left)">
                    <TextBlock Text="&#xE72B;" FontFamily="Segoe MDL2 Assets" FontSize="18" FontWeight="Bold"/>
                </Button>
                <Button x:Name="ForwardButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="ForwardButton_Click"
                        IsEnabled="False"
                        Margin="4,0,0,0"
                        ToolTip="Forward (Alt+Right)">
                    <TextBlock Text="&#xE72A;" FontFamily="Segoe MDL2 Assets" FontSize="18" FontWeight="Bold"/>
                </Button>
                <Button x:Name="ReloadButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="ReloadButton_Click"
                        Margin="4,0,0,0"
                        ToolTip="Reload (Ctrl+R)">
                    <TextBlock x:Name="ReloadIcon" Text="&#xE72C;" FontFamily="Segoe MDL2 Assets" FontSize="18" FontWeight="Bold"/>
                </Button>
            </StackPanel>

            <!-- Address Bar with Mode Icon inside -->
            <Grid Grid.Column="1" Margin="8,6">
                <TextBox x:Name="AddressBar"
                         Style="{StaticResource AddressBarStyle}"
                         KeyDown="AddressBar_KeyDown"
                         GotFocus="AddressBar_GotFocus"
                         Padding="18,0,32,0"/>
                <!-- Mode Icon overlay - positioned inside the textbox on the left -->
                <Grid Width="28" HorizontalAlignment="Left" Margin="4,0,0,0" IsHitTestVisible="False">
                    <!-- WWBW icon for WWBW mode -->
                    <Image x:Name="AddressBarWWBWIcon"
                           Source="Resources/Icons/wwbw.png"
                           Width="16" Height="16"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,2,0,0"
                           Visibility="Collapsed"/>
                    <!-- Globe icon for WWW mode (regular URLs) -->
                    <TextBlock x:Name="AddressBarGlobeIcon"
                              Text="&#xE774;"
                              FontFamily="Segoe MDL2 Assets"
                              FontSize="16"
                              Foreground="White"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Center"
                              Visibility="Visible"/>
                    <!-- WWBW icon for inspire:// URLs in WWW mode (white version) -->
                    <Image x:Name="AddressBarInspireIcon"
                           Source="Resources/Icons/wwbw-white.png"
                           Width="16" Height="16"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,2,0,0"
                           Visibility="Collapsed"/>
                </Grid>
                <!-- Magnifying Glass Icon for Zoom - shows when zoom != 100% -->
                <Button x:Name="ZoomMagnifierButton"
                        HorizontalAlignment="Right"
                        Margin="0,0,60,0"
                        Width="20" Height="20"
                        Background="Transparent"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="ZoomMagnifierButton_Click"
                        ToolTip="Zoom Options"
                        Visibility="Collapsed">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="Transparent">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                    <TextBlock x:Name="ZoomMagnifierIcon" Text="&#xE71E;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                </Button>
                <!-- Zoom Level Display - positioned inside the textbox on the right, before bookmark -->
                <Button x:Name="ZoomLevelButton"
                        HorizontalAlignment="Right"
                        Margin="0,0,26,0"
                        Padding="2,0"
                        Background="Transparent"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="ZoomLevelButton_Click"
                        ToolTip="Reset Zoom Level (Ctrl+0)"
                        Visibility="Collapsed">
                    <TextBlock x:Name="ZoomLevelText"
                              Text="100%"
                              FontSize="10"
                              Foreground="#888888"
                              VerticalAlignment="Center"/>
                </Button>
                <!-- Bookmark Star Icon - positioned inside the textbox on the right -->
                <Button x:Name="BookmarkButton"
                        Style="{StaticResource BookmarkButtonStyle}"
                        HorizontalAlignment="Right"
                        Margin="0,0,4,0"
                        Click="BookmarkButton_Click"
                        ToolTip="Add Bookmark (Ctrl+D)">
                    <TextBlock x:Name="BookmarkIcon" Text="&#xE734;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                </Button>
            </Grid>

            <!-- Mode Switch Button (after address bar) -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="4,0">
                <!-- Globe button - shown in WWBW mode to switch to WWW -->
                <Button x:Name="AddressBarModeGlobeButton"
                        Style="{StaticResource NavButtonStyle}"
                        Width="32" Height="32"
                        Click="ModeToggle_Click"
                        MouseEnter="AddressBarModeGlobeButton_MouseEnter"
                        MouseLeave="AddressBarModeGlobeButton_MouseLeave"
                        ToolTip="Switch to WWW mode"
                        Visibility="Collapsed">
                    <TextBlock x:Name="AddressBarModeGlobeIcon" Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="18" Foreground="Black"/>
                </Button>
                <!-- WWBW button - shown in WWW mode to switch to WWBW -->
                <Button x:Name="AddressBarModeBibleButton"
                        Style="{StaticResource NavButtonStyle}"
                        Width="32" Height="32"
                        Click="ModeToggle_Click"
                        MouseEnter="AddressBarModeBibleButton_MouseEnter"
                        MouseLeave="AddressBarModeBibleButton_MouseLeave"
                        ToolTip="Switch to WWBW mode"
                        Visibility="Visible">
                    <Grid>
                        <!-- White icon (default) -->
                        <Image x:Name="WWBWButtonIconWhite"
                               Source="Resources/Icons/wwbw-white.png"
                               Width="20" Height="20"
                               Visibility="Visible"/>
                        <!-- Yellow/color icon (on hover) -->
                        <Image x:Name="WWBWButtonIconColor"
                               Source="Resources/Icons/wwbw.png"
                               Width="20" Height="20"
                               Visibility="Collapsed"/>
                    </Grid>
                </Button>
            </StackPanel>

            <!-- Right Actions -->
            <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="8,0">
                <!-- Mode Toggle Button - shows icon to switch to other mode -->
                <Button x:Name="ModeToggleBorder"
                        Style="{StaticResource ModeToggleButtonStyle}"
                        Background="#000000"
                        Margin="8,0"
                        Click="ModeToggle_Click"
                        ToolTip="Switch to WWW mode">
                    <!-- Globe icon for switching to WWW mode (shown in WWBW mode) -->
                    <TextBlock x:Name="ModeToggleGlobeIcon"
                               Text="&#xE774;"
                               FontFamily="Segoe MDL2 Assets"
                               FontSize="14"
                               Foreground="#C8C8C8"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               Visibility="Collapsed"/>
                </Button>
                <!-- Profile/Avatar toggle for WWBW mode (shown in WWW mode) -->
                <Button x:Name="ModeToggleAvatarBorder"
                        Style="{StaticResource ModeToggleButtonStyle}"
                        Background="#0078D4"
                        Margin="8,0"
                        Click="ModeToggle_Click"
                        ToolTip="Switch to WWBW mode"
                        Visibility="Visible">
                    <Ellipse Width="20" Height="20" Stroke="White" StrokeThickness="1">
                        <Ellipse.Fill>
                            <ImageBrush x:Name="ModeToggleAvatarImage" ImageSource="Resources/Icons/icon.ico" Stretch="UniformToFill"/>
                        </Ellipse.Fill>
                    </Ellipse>
                </Button>
                <!-- Hidden radio buttons for state management -->
                <RadioButton x:Name="ModeRadioWWW"
                             GroupName="BrowserMode"
                             IsChecked="True"
                             Checked="ModeRadio_Changed"
                             Visibility="Collapsed"/>
                <RadioButton x:Name="ModeRadioWWBW"
                             GroupName="BrowserMode"
                             Checked="ModeRadio_Changed"
                             Visibility="Collapsed"/>

                <Button x:Name="HistoryButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="HistoryButton_Click"
                        ToolTip="History (Ctrl+H)">
                    <TextBlock Text="&#xE81C;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                </Button>
                <Button x:Name="BookmarksButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="BookmarksButton_Click"
                        ToolTip="Bookmarks (Ctrl+Shift+B)">
                    <TextBlock Text="&#xE728;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                </Button>
                <!-- Jubilee Chat Button - circular styling matching sign-in icon -->
                <Button x:Name="ChatButton"
                        Style="{StaticResource ProfileButtonStyle}"
                        Click="ChatButton_Click"
                        AutomationProperties.Name="Jubilee Chat">
                    <Button.ToolTip>
                        <ToolTip Style="{StaticResource NavBarTooltipStyle}" Content="Jubilee Chat"/>
                    </Button.ToolTip>
                    <Grid>
                        <!-- Circular background matching address bar color -->
                        <Ellipse x:Name="ChatButtonBackground"
                                Width="26" Height="26"
                                Fill="#252545"/>
                        <!-- Chat icon - white for contrast -->
                        <TextBlock x:Name="ChatIcon"
                                  Text="&#xE8BD;"
                                  FontFamily="Segoe MDL2 Assets"
                                  FontSize="14"
                                  Foreground="White"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                        <!-- Active indicator glow -->
                        <Ellipse x:Name="ChatActiveIndicator"
                                Width="8" Height="8"
                                Fill="#00BFFF"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Margin="0,-2,-2,0"
                                Visibility="Collapsed">
                            <Ellipse.Effect>
                                <DropShadowEffect Color="#00BFFF" BlurRadius="6" ShadowDepth="0" Opacity="0.8"/>
                            </Ellipse.Effect>
                        </Ellipse>
                    </Grid>
                </Button>
                <!-- Sign-In / Profile Button -->
                <Button x:Name="ProfileButton"
                        Style="{StaticResource ProfileButtonStyle}"
                        Click="ProfileButton_Click"
                        AutomationProperties.Name="Sign-In">
                    <Button.ToolTip>
                        <ToolTip Style="{StaticResource NavBarTooltipStyle}" Content="Sign-In"/>
                    </Button.ToolTip>
                    <Grid>
                        <!-- Default avatar (silhouette) when signed out - WWW mode uses #252545 background, white icon -->
                        <Ellipse x:Name="ProfileDefaultAvatar"
                                Width="26" Height="26"
                                Fill="#252545"
                                Visibility="Visible"/>
                        <!-- Material Symbols person icon (cleaner rounded user silhouette) -->
                        <Canvas x:Name="ProfileDefaultIcon" Width="14" Height="14" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Visible">
                            <!-- Head circle -->
                            <Ellipse x:Name="ProfileIconHead" Width="6" Height="6" Fill="White" Canvas.Left="4" Canvas.Top="0"/>
                            <!-- Body/shoulders arc -->
                            <Path x:Name="ProfileIconBody" Fill="White" Data="M 0,14 C 0,10 2,8 7,8 C 12,8 14,10 14,14 Z"/>
                        </Canvas>
                        <!-- User avatar when signed in -->
                        <Ellipse x:Name="ProfileUserAvatar"
                                Width="26" Height="26"
                                Stroke="#60a5fa"
                                StrokeThickness="2"
                                Visibility="Collapsed">
                            <Ellipse.Fill>
                                <ImageBrush x:Name="ProfileAvatarImage" Stretch="UniformToFill"/>
                            </Ellipse.Fill>
                        </Ellipse>
                        <!-- Sync indicator dot -->
                        <Ellipse x:Name="ProfileSyncIndicator"
                                Width="8" Height="8"
                                Fill="#22c55e"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                Margin="0,0,-2,-2"
                                Visibility="Collapsed"/>
                    </Grid>
                </Button>
                <!-- Menu Button (Material Symbols more_vert - 3 vertical dots) -->
                <Button x:Name="MenuButton"
                        Style="{StaticResource NavButtonStyle}"
                        Click="MenuButton_Click"
                        AutomationProperties.Name="Menu"
                        Margin="0,0,4,0">
                    <Button.ToolTip>
                        <ToolTip Style="{StaticResource NavBarTooltipStyle}" Content="Menu"/>
                    </Button.ToolTip>
                    <Canvas Width="16" Height="16">
                        <!-- Three vertical dots (more_vert icon from Material Symbols) -->
                        <Ellipse x:Name="MenuDot1" Width="4" Height="4" Fill="White" Canvas.Left="6" Canvas.Top="1"/>
                        <Ellipse x:Name="MenuDot2" Width="4" Height="4" Fill="White" Canvas.Left="6" Canvas.Top="6"/>
                        <Ellipse x:Name="MenuDot3" Width="4" Height="4" Fill="White" Canvas.Left="6" Canvas.Top="11"/>
                    </Canvas>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Favorites Bar - slides from behind navigation bar -->
        <Border x:Name="FavoritesBar"
                Grid.Row="2"
                Background="Black"
                BorderBrush="#333333"
                BorderThickness="0,0,0,1"
                Height="28"
                Visibility="Collapsed"
                ClipToBounds="False"
                RenderTransformOrigin="0.5,0">
            <Border.RenderTransform>
                <TranslateTransform x:Name="FavoritesBarTransform" Y="0"/>
            </Border.RenderTransform>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <!-- Favorites Content Container (for fade animation) -->
                <StackPanel x:Name="FavoritesContent" Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0" Opacity="0">
                    <!-- Communities -->
                    <Border x:Name="FavCommunities" Background="Transparent" CornerRadius="4" Padding="10,3" Margin="0,0,4,0" Cursor="Hand"
                            Tag="https://communities.jubileeverse.com"
                            MouseEnter="FavoriteItem_MouseEnter" MouseLeave="FavoriteItem_MouseLeave" MouseLeftButtonDown="FavoriteItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE716;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Communities" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    <!-- Jubilee Verse -->
                    <Border x:Name="FavJubileeVerse" Background="Transparent" CornerRadius="4" Padding="10,3" Margin="0,0,4,0" Cursor="Hand"
                            Tag="https://www.jubileeverse.com"
                            MouseEnter="FavoriteItem_MouseEnter" MouseLeave="FavoriteItem_MouseLeave" MouseLeftButtonDown="FavoriteItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE8BD;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Jubilee Verse" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    <!-- Books -->
                    <Border x:Name="FavBooks" Background="Transparent" CornerRadius="4" Padding="10,3" Margin="0,0,4,0" Cursor="Hand"
                            Tag="https://books.jubileeverse.com"
                            MouseEnter="FavoriteItem_MouseEnter" MouseLeave="FavoriteItem_MouseLeave" MouseLeftButtonDown="FavoriteItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE82D;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Books" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    <!-- Podcasts -->
                    <Border x:Name="FavPodcasts" Background="Transparent" CornerRadius="4" Padding="10,3" Margin="0,0,4,0" Cursor="Hand"
                            Tag="https://podcasts.jubileeverse.com"
                            MouseEnter="FavoriteItem_MouseEnter" MouseLeave="FavoriteItem_MouseLeave" MouseLeftButtonDown="FavoriteItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE720;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Podcasts" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    <!-- Music -->
                    <Border x:Name="FavMusic" Background="Transparent" CornerRadius="4" Padding="10,3" Margin="0,0,4,0" Cursor="Hand"
                            Tag="https://music.jubileeverse.com"
                            MouseEnter="FavoriteItem_MouseEnter" MouseLeave="FavoriteItem_MouseLeave" MouseLeftButtonDown="FavoriteItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE8D6;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Music" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
                <!-- Close Button (X) -->
                <Border x:Name="FavoritesCloseButton" Grid.Column="1" Background="Transparent" CornerRadius="4" Padding="8,3" Margin="0,0,12,0" Cursor="Hand"
                        VerticalAlignment="Center" Opacity="0"
                        MouseEnter="FavoritesCloseButton_MouseEnter" MouseLeave="FavoritesCloseButton_MouseLeave" MouseLeftButtonDown="FavoritesCloseButton_Click">
                    <TextBlock Text="&#xE711;" FontFamily="Segoe MDL2 Assets" FontSize="12" Foreground="White" VerticalAlignment="Center"/>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Grid x:Name="MainContentGrid" Grid.Row="3">
            <Grid.ColumnDefinitions>
                <!-- Side Panel (History/Bookmarks) -->
                <ColumnDefinition x:Name="SidePanelColumn" Width="0"/>
                <!-- Browser Content -->
                <ColumnDefinition Width="*"/>
                <!-- Chat Panel Splitter -->
                <ColumnDefinition x:Name="ChatSplitterColumn" Width="0"/>
                <!-- Chat Panel -->
                <ColumnDefinition x:Name="ChatPanelColumn" Width="0"/>
            </Grid.ColumnDefinitions>

            <!-- Side Panel -->
            <Border x:Name="SidePanel"
                    Grid.Column="0"
                    Background="{StaticResource BgSecondaryBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,1,0"
                    Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Side Panel Header -->
                    <Border Grid.Row="0"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="0,0,0,1">
                        <Grid>
                            <TextBlock x:Name="SidePanelTitle"
                                      Text="History"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      FontSize="14"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"
                                      Margin="12,0"/>
                            <Button Style="{StaticResource NavButtonStyle}"
                                    HorizontalAlignment="Right"
                                    Margin="4"
                                    Click="CloseSidePanel_Click">
                                <TextBlock Text="&#xE8BB;" FontFamily="Segoe MDL2 Assets" FontSize="10"/>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Side Panel Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ListBox x:Name="SidePanelList"
                                Background="Transparent"
                                BorderThickness="0"
                                Foreground="{StaticResource TextPrimaryBrush}"
                                SelectionChanged="SidePanelList_SelectionChanged"/>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- WebView Container with Mobile Emulation -->
            <DockPanel Grid.Column="1" Background="{StaticResource BgPrimaryBrush}">
                <!-- Mobile Emulation Panel (docked at top, initially hidden) -->
                <controls:MobileEmulationPanel x:Name="MobileEmulationPanel"
                                               DockPanel.Dock="Top"
                                               Visibility="Collapsed"
                                               DeviceSelected="MobileEmulationPanel_DeviceSelected"
                                               DimensionsChanged="MobileEmulationPanel_DimensionsChanged"
                                               OrientationChanged="MobileEmulationPanel_OrientationChanged"
                                               DprChanged="MobileEmulationPanel_DprChanged"
                                               NetworkThrottleChanged="MobileEmulationPanel_NetworkThrottleChanged"
                                               CpuThrottleChanged="MobileEmulationPanel_CpuThrottleChanged"
                                               CloseRequested="MobileEmulationPanel_CloseRequested"/>

                <!-- WebView Content Area -->
                <Grid x:Name="WebViewContainer">
                    <!-- Welcome Message (shown when no tabs) -->
                    <StackPanel x:Name="WelcomePanel"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Visibility="Collapsed">
                        <TextBlock Text="Welcome to Jubilee Browser"
                                  Foreground="{StaticResource TextPrimaryBrush}"
                                  FontSize="28"
                                  FontWeight="Light"
                                  HorizontalAlignment="Center"/>
                        <TextBlock Text="Press Ctrl+T to open a new tab"
                                  Foreground="{StaticResource TextSecondaryBrush}"
                                  FontSize="14"
                                  Margin="0,12,0,0"
                                  HorizontalAlignment="Center"/>
                    </StackPanel>

                    <!-- Loading Indicator -->
                    <ProgressBar x:Name="LoadingBar"
                                Height="2"
                                VerticalAlignment="Top"
                                IsIndeterminate="True"
                                Visibility="Collapsed"
                                Foreground="{StaticResource AccentBrush}"
                                Background="Transparent"
                                BorderThickness="0"/>

                    <!-- Zoom Overlay - appears below address bar when zooming -->
                    <Border x:Name="ZoomOverlay"
                            VerticalAlignment="Top"
                            HorizontalAlignment="Center"
                            Margin="0,8,0,0"
                            Background="#CC000000"
                            CornerRadius="8"
                            Padding="16,10"
                            Visibility="Collapsed"
                            Panel.ZIndex="100">
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="2" Opacity="0.5"/>
                        </Border.Effect>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <!-- Zoom Out Button -->
                            <Button x:Name="ZoomOverlayMinusButton"
                                    Width="28" Height="28"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="ZoomOverlayMinus_Click"
                                    ToolTip="Zoom Out (Ctrl+-)">
                                <TextBlock Text="&#xE738;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Button>
                            <!-- Zoom Level Display -->
                            <TextBlock x:Name="ZoomOverlayText"
                                      Text="100%"
                                      Foreground="White"
                                      FontSize="14"
                                      FontWeight="SemiBold"
                                      VerticalAlignment="Center"
                                      Margin="8,0"
                                      MinWidth="50"
                                      TextAlignment="Center"/>
                            <!-- Zoom In Button -->
                            <Button x:Name="ZoomOverlayPlusButton"
                                    Width="28" Height="28"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="ZoomOverlayPlus_Click"
                                    ToolTip="Zoom In (Ctrl++)">
                                <TextBlock Text="&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Button>
                            <!-- Separator -->
                            <Border Width="1" Height="20" Background="#555555" Margin="8,0"/>
                            <!-- Reset Button -->
                            <Button x:Name="ZoomOverlayResetButton"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Padding="8,4"
                                    Click="ZoomOverlayReset_Click"
                                    ToolTip="Reset to 100% (Ctrl+0)">
                                <TextBlock Text="Reset" Foreground="White" FontSize="12" VerticalAlignment="Center"/>
                            </Button>
                        </StackPanel>
                    </Border>
                </Grid>
            </DockPanel>

            <!-- Chat Panel Splitter -->
            <GridSplitter x:Name="ChatSplitter"
                         Grid.Column="2"
                         Width="4"
                         Background="#2a2a4e"
                         HorizontalAlignment="Stretch"
                         Cursor="SizeWE"
                         Visibility="Collapsed"/>

            <!-- Jubilee Chat Panel - JubileeVerse.com Style -->
            <Border x:Name="ChatPanel"
                    Grid.Column="3"
                    Background="#000000"
                    BorderBrush="#333333"
                    BorderThickness="1,0,0,0"
                    Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <!-- Top Bar with close button and flags -->
                        <RowDefinition Height="Auto"/>
                        <!-- Main Content Area (Avatar, Logo, Messages, Input) -->
                        <RowDefinition Height="*"/>
                        <!-- Footer -->
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Top Bar -->
                    <Border Grid.Row="0" Background="#000000" Padding="8,8,8,4">
                        <Grid>
                            <!-- Left side: Language Icon -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <!-- Language Selector -->
                                <Border Width="32" Height="32" CornerRadius="6" Background="#1a1a1a" Cursor="Hand" ToolTip="Select Language">
                                    <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="14" Foreground="#888888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </StackPanel>
                            <!-- Close Button on Right -->
                            <Button x:Name="ChatCloseButton"
                                    Width="32" Height="32"
                                    HorizontalAlignment="Right"
                                    Click="ChatCloseButton_Click"
                                    Cursor="Hand"
                                    ToolTip="Close Chat">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" Background="Transparent" CornerRadius="6">
                                            <TextBlock Text="&#xE711;" FontFamily="Segoe MDL2 Assets" FontSize="14" Foreground="#888888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#333333"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <!-- Hidden elements kept for compatibility -->
                            <TextBlock x:Name="ChatProfileIcon" Visibility="Collapsed"/>
                            <Ellipse x:Name="ChatUserAvatar" Visibility="Collapsed">
                                <Ellipse.Fill>
                                    <ImageBrush x:Name="ChatUserAvatarImage" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                    </Border>

                    <!-- Main Content Area -->
                    <ScrollViewer x:Name="ChatMessagesScroller"
                                 Grid.Row="1"
                                 VerticalScrollBarVisibility="Auto"
                                 Background="#000000">
                        <Grid>
                            <StackPanel x:Name="ChatMessagesPanel" Margin="0" VerticalAlignment="Center" HorizontalAlignment="Stretch" SizeChanged="ChatMessagesPanel_SizeChanged">

                                <!-- Avatar Container - 97px (10% smaller), 2px to brand text, focusable -->
                                <Border x:Name="ChatWelcomeMessage" HorizontalAlignment="Center" Margin="0,0,0,2" Focusable="True">
                                    <Grid Width="97" Height="97">
                                        <!-- Avatar image container (loaded from web) -->
                                        <Ellipse x:Name="ChatAvatarImageContainer" Width="97" Height="97" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Collapsed">
                                            <Ellipse.Fill>
                                                <ImageBrush x:Name="ChatAvatarBrush" Stretch="UniformToFill"/>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                        <!-- Fallback AI Icon (shown by default until image loads) -->
                                        <Grid x:Name="ChatAvatarFallback" Visibility="Visible">
                                            <Ellipse Width="97" Height="97" Fill="#1a1a2e" HorizontalAlignment="Center" VerticalAlignment="Center" Stroke="#00BFFF" StrokeThickness="3"/>
                                            <TextBlock Text="&#xE716;" FontFamily="Segoe MDL2 Assets" FontSize="39" Foreground="#00BFFF" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Grid>
                                        <!-- BETA Badge - Medium gray, 30px right offset -->
                                        <Border HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                               Background="#808080" CornerRadius="8" Padding="8,4" Margin="0,0,-30,-5">
                                            <TextBlock Text="BETA" FontSize="11" FontWeight="Bold" Foreground="#FFFFFF" FontFamily="Segoe UI"/>
                                        </Border>
                                    </Grid>
                                </Border>

                                <!-- JubileeInspire.com Brand Text - Primary visual element, -4px to subtitle -->
                                <TextBlock HorizontalAlignment="Center" Margin="0,0,0,-4" FontSize="36" FontFamily="Agency FB, Impact, Arial Black, sans-serif" LineHeight="40"><Run Text="Jubilee" FontWeight="Bold" Foreground="White"/><Run Text="Inspire" FontWeight="Bold" Foreground="#E6AC00"/><Run Text=".com" FontWeight="Bold" Foreground="White"/></TextBlock>

                                <!-- Subtitle - Secondary descriptor, -15px to input -->
                                <TextBlock Text="An Interactive AI Bible Experience for Exploring Scripture with Greater Depth"
                                          HorizontalAlignment="Center"
                                          TextWrapping="Wrap"
                                          TextAlignment="Center"
                                          Margin="0,0,0,-15"
                                          FontSize="9"
                                          LineHeight="12"
                                          Foreground="White"/>

                                <!-- Hidden Sign In Prompt (kept for compatibility but hidden by default) -->
                                <Border x:Name="ChatSignInPrompt" Visibility="Collapsed"/>

                                <!-- User status text -->
                                <TextBlock x:Name="ChatUserStatus"
                                          Text=""
                                          FontSize="11"
                                          Foreground="#666666"
                                          HorizontalAlignment="Center"
                                          Margin="0,0,0,8"/>

                                <!-- Chat Input Area - Rectangle with rounded corners, 90% width -->
                                <Border x:Name="ChatInputBorder" Background="#3a3a3a"
                                       CornerRadius="8"
                                       Padding="4"
                                       HorizontalAlignment="Stretch"
                                       Height="36">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Input TextBox with Placeholder -->
                                        <Grid Grid.Column="0">
                                            <TextBox x:Name="ChatInputBox"
                                                    Background="Transparent"
                                                    Foreground="White"
                                                    CaretBrush="White"
                                                    BorderThickness="0"
                                                    FontSize="13"
                                                    VerticalAlignment="Center"
                                                    Padding="12,4,12,8"
                                                    AcceptsReturn="False"
                                                    KeyDown="ChatInputBox_KeyDown"
                                                    GotFocus="ChatInputBox_GotFocus"
                                                    LostFocus="ChatInputBox_LostFocus"
                                                    IsEnabled="True"/>
                                            <TextBlock x:Name="ChatInputPlaceholder"
                                                      Text="Ask Jubilee Anything..."
                                                      Foreground="#888888"
                                                      FontSize="13"
                                                      VerticalAlignment="Center"
                                                      Margin="12,-2,0,0"
                                                      IsHitTestVisible="False"/>
                                        </Grid>

                                        <!-- Send Button - Yellow Circle, 10% smaller (25px) -->
                                        <Button x:Name="ChatSendButton"
                                               Grid.Column="1"
                                               Width="25" Height="25"
                                               Margin="4,0,4,0"
                                               Background="#E6AC00"
                                               Cursor="Hand"
                                               Click="ChatSendButton_Click"
                                               IsEnabled="True"
                                               ToolTip="Send Message">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border"
                                                           Background="{TemplateBinding Background}"
                                                           CornerRadius="12.5">
                                                        <TextBlock Text="&#xE72A;"
                                                                  FontFamily="Segoe MDL2 Assets"
                                                                  FontSize="12"
                                                                  Foreground="Black"
                                                                  HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#FFBF00"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled" Value="False">
                                                            <Setter TargetName="border" Property="Background" Value="#3a3a5e"/>
                                                            <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </Grid>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>

                    <!-- Footer -->
                    <Border Grid.Row="2" Background="#000000" Padding="8,12">
                        <TextBlock TextWrapping="Wrap" TextAlignment="Center" FontSize="10" Foreground="#555555" LineHeight="14">
                            <Run Text="Copyright  2026 JubileeVerse.com | All Rights Reserved."/>
                            <LineBreak/>
                            <Run Text="JubileeVerse and AI can make mistakes. | "/>
                            <Run Text="Privacy Policy" Foreground="#777777" TextDecorations="Underline"/>
                            <Run Text=" | "/>
                            <Run Text="Terms of Use" Foreground="#777777" TextDecorations="Underline"/>
                        </TextBlock>
                    </Border>
                </Grid>
            </Border>

            <!-- Fade Overlay for Chat Panel Transition -->
            <Grid x:Name="FadeOverlay"
                  Grid.Column="0"
                  Grid.ColumnSpan="4"
                  Background="Black"
                  Opacity="0"
                  Visibility="Collapsed"
                  IsHitTestVisible="True"
                  Panel.ZIndex="100"/>
        </Grid>

        <!-- RESIZE BORDERS - Must be LAST in Grid to be on top of WebView2 -->
        <!-- These span all rows and sit on top of everything to intercept mouse events -->

        <!-- Left Edge -->
        <Rectangle x:Name="ResizeLeft"
                   Grid.Row="3"
                   Width="3"
                   HorizontalAlignment="Left"
                   Fill="Transparent"
                   Cursor="SizeWE"
                   MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown"
                   Tag="Left"/>

        <!-- Right Edge -->
        <Rectangle x:Name="ResizeRight"
                   Grid.Row="3"
                   Width="3"
                   HorizontalAlignment="Right"
                   Fill="Transparent"
                   Cursor="SizeWE"
                   MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown"
                   Tag="Right"/>

        <!-- Bottom Edge -->
        <Rectangle x:Name="ResizeBottom"
                   Grid.Row="3"
                   Height="3"
                   VerticalAlignment="Bottom"
                   Fill="Transparent"
                   Cursor="SizeNS"
                   MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown"
                   Tag="Bottom"/>

        <!-- Bottom-Left Corner -->
        <Rectangle x:Name="ResizeBottomLeft"
                   Grid.Row="3"
                   Width="8" Height="8"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Bottom"
                   Fill="Transparent"
                   Cursor="SizeNESW"
                   MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown"
                   Tag="BottomLeft"/>

        <!-- Bottom-Right Corner -->
        <Rectangle x:Name="ResizeBottomRight"
                   Grid.Row="3"
                   Width="8" Height="8"
                   HorizontalAlignment="Right"
                   VerticalAlignment="Bottom"
                   Fill="Transparent"
                   Cursor="SizeNWSE"
                   MouseLeftButtonDown="ResizeBorder_MouseLeftButtonDown"
                   Tag="BottomRight"/>

        <!-- Profile Popup -->
        <Popup x:Name="ProfilePopup"
               PlacementTarget="{Binding ElementName=ProfileButton}"
               Placement="Bottom"
               HorizontalOffset="-130"
               VerticalOffset="4"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="None">
            <Border x:Name="ProfilePopupBorder"
                    Background="#1e1e2e"
                    BorderBrush="#3a3a5e"
                    BorderThickness="1"
                    CornerRadius="12"
                    Width="300">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.4" Color="Black"/>
                </Border.Effect>
                <StackPanel>
                    <!-- Signed Out State -->
                    <StackPanel x:Name="ProfileSignedOutPanel" Visibility="Visible" Margin="20">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <!-- Profile circle with person silhouette -->
                            <Grid Width="48" Height="48" Margin="0,0,16,0">
                                <Ellipse Fill="#3a3a5e"/>
                                <TextBlock Text="&#xE77B;" FontFamily="Segoe MDL2 Assets" FontSize="24"
                                           Foreground="#888888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Sign in to sync your data" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <TextBlock Text="Access your data across devices" FontSize="12" Foreground="#FFD700" Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>
                        <Button x:Name="ProfileSignInButton"
                                Click="ProfileSignIn_Click"
                                Background="#E6AC00"
                                Margin="0,0,0,8"
                                Padding="16,10"
                                Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                            <TextBlock Text="Sign In" FontWeight="Bold" FontSize="14" Foreground="Black"/>
                        </Button>
                        <TextBlock Text="Create a Jubilee account to sync bookmarks, history, passwords, and settings across all your devices."
                                  TextWrapping="Wrap" FontSize="11" Foreground="White" Margin="0,8,0,0" TextAlignment="Center"/>
                    </StackPanel>

                    <!-- Signed In State -->
                    <StackPanel x:Name="ProfileSignedInPanel" Visibility="Collapsed">
                        <!-- Profile Header -->
                        <StackPanel Orientation="Horizontal" Margin="20,20,20,12">
                            <Ellipse x:Name="ProfilePopupAvatar" Width="48" Height="48" Margin="0,0,16,0">
                                <Ellipse.Fill>
                                    <ImageBrush x:Name="ProfilePopupAvatarImage" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock x:Name="ProfilePopupName" Text="User Name" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <TextBlock x:Name="ProfilePopupEmail" Text="user@example.com" FontSize="12" Foreground="#808080" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Button Style="{StaticResource NavButtonStyle}"
                                    Width="28" Height="28"
                                    VerticalAlignment="Top"
                                    HorizontalAlignment="Right"
                                    Click="ProfileSettings_Click"
                                    ToolTip="Profile settings"
                                    Margin="20,0,0,0">
                                <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
                            </Button>
                        </StackPanel>

                        <!-- Sync Status -->
                        <Border x:Name="ProfileSyncStatusBorder"
                                Background="#1a3a1a"
                                CornerRadius="6"
                                Margin="16,0,16,12"
                                Padding="12,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="ProfileSyncStatusIcon"
                                          Text="&#xE895;"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="14"
                                          Foreground="#22c55e"
                                          VerticalAlignment="Center"
                                          Margin="0,0,8,0"/>
                                <StackPanel>
                                    <TextBlock x:Name="ProfileSyncStatusText" Text="Syncing is on" FontSize="12" Foreground="#22c55e"/>
                                    <TextBlock x:Name="ProfileSyncLastTime" Text="Last synced: just now" FontSize="10" Foreground="#606060" Margin="0,2,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Sync Error Banner (hidden by default) -->
                        <Border x:Name="ProfileSyncErrorBanner"
                                Background="#3a1a1a"
                                CornerRadius="6"
                                Margin="16,0,16,12"
                                Padding="12,8"
                                Visibility="Collapsed">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE7BA;"
                                          FontFamily="Segoe MDL2 Assets"
                                          FontSize="14"
                                          Foreground="#ef4444"
                                          VerticalAlignment="Center"
                                          Margin="0,0,8,0"/>
                                <StackPanel>
                                    <TextBlock x:Name="ProfileSyncErrorText" Text="Sync error" FontSize="12" Foreground="#ef4444"/>
                                    <Button Style="{StaticResource ProfileLinkButtonStyle}"
                                            Content="Retry sync"
                                            Click="ProfileRetrySync_Click"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}" Margin="16,4"/>

                        <!-- Actions -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="ProfileManageAccount_Click" Margin="4,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE716;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24"/>
                                <TextBlock Text="Manage your Jubilee account" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="ProfileSwitchProfile_Click" Margin="4,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE748;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24"/>
                                <TextBlock Text="Switch profile" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="ProfileSyncSettings_Click" Margin="4,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE895;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24"/>
                                <TextBlock Text="Sync settings" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}" Margin="16,4"/>

                        <!-- Sign Out -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="ProfileSignOut_Click" Margin="4,0,4,8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xF3B1;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" Foreground="#ef4444"/>
                                <TextBlock Text="Sign out" VerticalAlignment="Center" Foreground="#ef4444"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Popup>

        <!-- Main Menu Popup -->
        <Popup x:Name="MainMenuPopup"
               PlacementTarget="{Binding ElementName=MenuButton}"
               Placement="Bottom"
               HorizontalOffset="-280"
               VerticalOffset="4"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="None">
            <Border x:Name="MainMenuBorder"
                    Background="#1e1e2e"
                    BorderBrush="#3a3a5e"
                    BorderThickness="1"
                    CornerRadius="8"
                    Width="320"
                    MaxHeight="600"
                    Opacity="0">
                <Border.RenderTransform>
                    <TranslateTransform/>
                </Border.RenderTransform>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.4" Color="Black"/>
                </Border.Effect>
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Style="{StaticResource MenuScrollViewerStyle}">
                    <StackPanel Margin="4,8">
                        <!-- User Profile Section -->
                        <Button x:Name="MainMenuProfileButton" Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Profile_Click"
                                AutomationProperties.Name="User Profile">
                            <StackPanel Orientation="Horizontal">
                                <Grid Width="32" Height="32" Margin="0,0,12,0">
                                    <!-- Default user silhouette icon -->
                                    <Ellipse Fill="#3A3A4A"/>
                                    <TextBlock x:Name="MainMenuProfileIcon" Text="&#xE77B;" FontFamily="Segoe MDL2 Assets" FontSize="18"
                                               Foreground="#888888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    <!-- Profile image (shown when logged in) -->
                                    <Ellipse x:Name="MainMenuProfileImageEllipse" Visibility="Collapsed">
                                        <Ellipse.Fill>
                                            <ImageBrush x:Name="MainMenuProfileImage" ImageSource="Resources/Icons/icon.ico" Stretch="UniformToFill"/>
                                        </Ellipse.Fill>
                                    </Ellipse>
                                </Grid>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock x:Name="MainMenuProfileName" Text="Sign in" FontWeight="SemiBold" FontSize="13"/>
                                    <TextBlock x:Name="MainMenuProfileEmail" Text="Sync your data across devices" FontSize="11" Foreground="#FFD700"/>
                                </StackPanel>
                            </StackPanel>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- New Tab/Window Section -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_NewTab_Click"
                                AutomationProperties.Name="New Tab" AutomationProperties.AcceleratorKey="Ctrl+T">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="New tab" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+T" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_NewWindow_Click"
                                AutomationProperties.Name="New Window" AutomationProperties.AcceleratorKey="Ctrl+N">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE78B;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="New window" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+N" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_NewWWBWWindow_Click"
                                AutomationProperties.Name="New WWBW Window" AutomationProperties.AcceleratorKey="Ctrl+Shift+N">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE72E;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="New WWBW window" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+Shift+N" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Favorites, History, Downloads -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Favorites_Click"
                                AutomationProperties.Name="Favorites">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE728;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Favorites" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+Shift+B" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_History_Click"
                                AutomationProperties.Name="History">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE81C;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="History" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+H" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Downloads_Click"
                                AutomationProperties.Name="Downloads">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE896;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Downloads" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+J" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- More Tools Expander -->
                        <Button x:Name="MoreToolsButton" Style="{StaticResource MainMenuExpanderStyle}" Click="MainMenu_MoreTools_Click"
                                AutomationProperties.Name="More Tools">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24"/>
                                <TextBlock Text="More tools" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <!-- More Tools Submenu (initially collapsed) -->
                        <StackPanel x:Name="MoreToolsPanel" Visibility="Collapsed" Margin="24,0,0,0">
                            <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Extensions_Click"
                                    AutomationProperties.Name="Extensions">
                                <Grid Width="196">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="&#xEA86;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Extensions" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_TaskManager_Click"
                                    AutomationProperties.Name="Browser Task Manager">
                                <Grid Width="196">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="&#xE9D9;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Browser task manager" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Shift+Esc" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                                </Grid>
                            </Button>
                            <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_DevTools_Click"
                                    AutomationProperties.Name="Developer Tools">
                                <Grid Width="196">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="&#xEC7A;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Developer tools" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="F12" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                                </Grid>
                            </Button>
                            <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_WebCapture_Click"
                                    AutomationProperties.Name="Web Capture">
                                <Grid Width="196">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="&#xE924;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" Text="Web capture" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Ctrl+Shift+S" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                                </Grid>
                            </Button>
                            <Button x:Name="MobileViewMenuButton" Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_MobileView_Click"
                                    AutomationProperties.Name="Mobile View">
                                <Grid Width="196">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="&#xE1C9;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="MobileViewMenuText" Grid.Column="1" Text="Toggle mobile view" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="Ctrl+Shift+M" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                                </Grid>
                            </Button>
                        </StackPanel>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Zoom Controls -->
                        <Grid Margin="16,6">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="&#xE71E;" FontFamily="Segoe MDL2 Assets" FontSize="14" VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Grid.Column="1" Text="Zoom" VerticalAlignment="Center"/>
                            <Button Grid.Column="2" Style="{StaticResource NavButtonStyle}" Width="28" Height="28" Click="MainMenu_ZoomOut_Click" ToolTip="Zoom out (Ctrl+-)">
                                <TextBlock Text="&#xE738;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
                            </Button>
                            <TextBlock x:Name="MainMenuZoomLevel" Grid.Column="3" Text="100%" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="12"/>
                            <Button Grid.Column="4" Style="{StaticResource NavButtonStyle}" Width="28" Height="28" Click="MainMenu_ZoomIn_Click" ToolTip="Zoom in (Ctrl++)">
                                <TextBlock Text="&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
                            </Button>
                        </Grid>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Print and Settings -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Print_Click"
                                AutomationProperties.Name="Print">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE749;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Print" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+P" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Settings_Click"
                                AutomationProperties.Name="Settings">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Settings" VerticalAlignment="Center"/>
                            </Grid>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Clear Browsing Data -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_ClearBrowsingData_Click"
                                AutomationProperties.Name="Clear Browsing Data">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE74D;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Clear browsing data" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Ctrl+Shift+Del" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Help, Feedback, About -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Help_Click"
                                AutomationProperties.Name="Help">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE897;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Help" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="F1" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Feedback_Click"
                                AutomationProperties.Name="Send Feedback">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xED15;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Send feedback" VerticalAlignment="Center"/>
                            </Grid>
                        </Button>
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_About_Click"
                                AutomationProperties.Name="About Jubilee Browser">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="About Jubilee Browser" VerticalAlignment="Center"/>
                            </Grid>
                        </Button>

                        <Border Style="{StaticResource MainMenuSeparatorStyle}"/>

                        <!-- Exit -->
                        <Button Style="{StaticResource MainMenuItemStyle}" Click="MainMenu_Exit_Click"
                                AutomationProperties.Name="Exit">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="&#xE7E8;" FontFamily="Segoe MDL2 Assets" FontSize="14" Width="24" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Exit" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="Alt+F4" Foreground="#FFD700" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                            </Grid>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Popup>

    </Grid>
</Window>
