<UserControl x:Class="JubileeBrowser.Controls.MobileEmulationPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="60" d:DesignWidth="800"
             Background="#1a1a2e">

    <UserControl.Resources>
        <!-- ComboBox Style -->
        <Style x:Key="DeviceComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                         Template="{DynamicResource ComboBoxToggleButton}"
                                         Grid.Column="2"
                                         Focusable="false"
                                         ClickMode="Press"
                                         IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <ContentPresenter x:Name="ContentSite"
                                            IsHitTestVisible="False"
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                            Margin="10,3,23,3"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"/>
                            <Popup x:Name="Popup"
                                  Placement="Bottom"
                                  IsOpen="{TemplateBinding IsDropDownOpen}"
                                  AllowsTransparency="True"
                                  Focusable="False"
                                  PopupAnimation="Slide">
                                <Grid x:Name="DropDown"
                                     SnapsToDevicePixels="True"
                                     MinWidth="{TemplateBinding ActualWidth}"
                                     MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder"
                                           Background="#252545"
                                           BorderBrush="#3a3a5e"
                                           BorderThickness="1"
                                           CornerRadius="4"
                                           Margin="0,2,0,0"/>
                                    <ScrollViewer Margin="4,6" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBox Toggle Button -->
        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="20"/>
                </Grid.ColumnDefinitions>
                <Border x:Name="Border"
                       Grid.ColumnSpan="2"
                       Background="#252545"
                       BorderBrush="#3a3a5e"
                       BorderThickness="1"
                       CornerRadius="4"/>
                <Path x:Name="Arrow"
                     Grid.Column="1"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     Data="M 0 0 L 4 4 L 8 0 Z"
                     Fill="White"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="Background" Value="#353555"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!-- ComboBox Item Style -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Border"
                               Background="{TemplateBinding Background}"
                               Padding="{TemplateBinding Padding}"
                               CornerRadius="3">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#3a3a5e"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#0f3460"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Panel Button Style -->
        <Style x:Key="PanelButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                               Background="{TemplateBinding Background}"
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="4"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#353555"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#454565"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Toggle Button Style for Orientation -->
        <Style x:Key="OrientationToggleStyle" TargetType="ToggleButton">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Width" Value="32"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border"
                               Background="{TemplateBinding Background}"
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="4"
                               Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#353555"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#0f3460"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#FFD700"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- TextBox Style -->
        <Style x:Key="DimensionTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Width" Value="60"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                               Background="{TemplateBinding Background}"
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#FFD700"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Border BorderBrush="#3a3a5e" BorderThickness="0,0,0,1" Padding="12,8">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Mobile Icon -->
            <TextBlock Grid.Column="0" Text="&#xE1C9;" FontFamily="Segoe MDL2 Assets" FontSize="16"
                      Foreground="#FFD700" VerticalAlignment="Center" Margin="0,0,12,0"
                      ToolTip="Mobile Device Emulation Active"/>

            <!-- Device Selector -->
            <ComboBox x:Name="DeviceSelector" Grid.Column="1"
                     Style="{StaticResource DeviceComboBoxStyle}"
                     Width="180"
                     SelectionChanged="DeviceSelector_SelectionChanged"
                     ToolTip="Select device to emulate"/>

            <!-- Dimensions Display/Input -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                <TextBox x:Name="WidthInput" Style="{StaticResource DimensionTextBoxStyle}"
                        TextChanged="DimensionInput_TextChanged"
                        PreviewTextInput="DimensionInput_PreviewTextInput"
                        ToolTip="Viewport width"/>
                <TextBlock Text=" x " Foreground="#808080" VerticalAlignment="Center" FontSize="12"/>
                <TextBox x:Name="HeightInput" Style="{StaticResource DimensionTextBoxStyle}"
                        TextChanged="DimensionInput_TextChanged"
                        PreviewTextInput="DimensionInput_PreviewTextInput"
                        ToolTip="Viewport height"/>
            </StackPanel>

            <!-- DPR Selector -->
            <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="DPR:" Foreground="#808080" VerticalAlignment="Center" FontSize="12" Margin="0,0,6,0"/>
                <ComboBox x:Name="DprSelector" Style="{StaticResource DeviceComboBoxStyle}"
                         Width="60"
                         SelectionChanged="DprSelector_SelectionChanged"
                         ToolTip="Device Pixel Ratio">
                    <ComboBoxItem Content="1" Tag="1"/>
                    <ComboBoxItem Content="1.5" Tag="1.5"/>
                    <ComboBoxItem Content="2" Tag="2"/>
                    <ComboBoxItem Content="2.5" Tag="2.5"/>
                    <ComboBoxItem Content="3" Tag="3"/>
                </ComboBox>
            </StackPanel>

            <!-- Orientation Toggle -->
            <StackPanel Grid.Column="4" Orientation="Horizontal" Margin="12,0,0,0">
                <ToggleButton x:Name="PortraitButton" Style="{StaticResource OrientationToggleStyle}"
                             IsChecked="True"
                             Click="OrientationButton_Click"
                             ToolTip="Portrait orientation">
                    <TextBlock Text="&#xE1E2;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                </ToggleButton>
                <ToggleButton x:Name="LandscapeButton" Style="{StaticResource OrientationToggleStyle}"
                             Margin="4,0,0,0"
                             Click="OrientationButton_Click"
                             ToolTip="Landscape orientation">
                    <TextBlock Text="&#xE1E2;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                              RenderTransformOrigin="0.5,0.5">
                        <TextBlock.RenderTransform>
                            <RotateTransform Angle="90"/>
                        </TextBlock.RenderTransform>
                    </TextBlock>
                </ToggleButton>
            </StackPanel>

            <!-- Network Throttling -->
            <StackPanel Grid.Column="5" Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="&#xE701;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                          Foreground="#808080" VerticalAlignment="Center" Margin="0,0,6,0"
                          ToolTip="Network throttling"/>
                <ComboBox x:Name="NetworkThrottleSelector" Style="{StaticResource DeviceComboBoxStyle}"
                         Width="100"
                         SelectionChanged="NetworkThrottleSelector_SelectionChanged"
                         ToolTip="Network throttle preset">
                    <ComboBoxItem Content="No throttle" Tag="None"/>
                    <ComboBoxItem Content="Fast 4G" Tag="Fast4G"/>
                    <ComboBoxItem Content="Slow 4G" Tag="Slow4G"/>
                    <ComboBoxItem Content="Fast 3G" Tag="Fast3G"/>
                    <ComboBoxItem Content="Slow 3G" Tag="Slow3G"/>
                    <ComboBoxItem Content="Offline" Tag="Offline"/>
                </ComboBox>
            </StackPanel>

            <!-- CPU Throttling -->
            <StackPanel Grid.Column="6" Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="&#xE950;" FontFamily="Segoe MDL2 Assets" FontSize="14"
                          Foreground="#808080" VerticalAlignment="Center" Margin="0,0,6,0"
                          ToolTip="CPU throttling"/>
                <ComboBox x:Name="CpuThrottleSelector" Style="{StaticResource DeviceComboBoxStyle}"
                         Width="100"
                         SelectionChanged="CpuThrottleSelector_SelectionChanged"
                         ToolTip="CPU throttle preset">
                    <ComboBoxItem Content="No throttle" Tag="None"/>
                    <ComboBoxItem Content="2x slowdown" Tag="LowEnd2x"/>
                    <ComboBoxItem Content="4x slowdown" Tag="MidTier4x"/>
                    <ComboBoxItem Content="6x slowdown" Tag="LowTier6x"/>
                </ComboBox>
            </StackPanel>

            <!-- Spacer -->
            <Grid Grid.Column="7"/>

            <!-- Close Button -->
            <Button x:Name="CloseButton" Grid.Column="8" Style="{StaticResource PanelButtonStyle}"
                   Width="32" Click="CloseButton_Click"
                   ToolTip="Exit mobile emulation mode">
                <TextBlock Text="&#xE711;" FontFamily="Segoe MDL2 Assets" FontSize="12"/>
            </Button>
        </Grid>
    </Border>
</UserControl>
