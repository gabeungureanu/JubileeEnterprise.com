<UserControl x:Class="JubileeVibes.Views.Pages.ArtistView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             mc:Ignorable="d"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             d:DesignHeight="700" d:DesignWidth="1000"
             Background="Transparent">

    <ScrollViewer Style="{StaticResource VibesScrollViewerStyle}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="340"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Artist Header -->
            <Grid Grid.Row="0">
                <Grid.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#404040" Offset="0"/>
                        <GradientStop Color="#181818" Offset="1"/>
                    </LinearGradientBrush>
                </Grid.Background>

                <StackPanel VerticalAlignment="Bottom" Margin="32,0,32,24">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Path Data="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"
                              Fill="#509BF5"
                              Width="24" Height="24"
                              Stretch="Uniform"
                              Visibility="{Binding Artist.IsVerified, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        <TextBlock Text="Verified Artist"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   FontSize="14"
                                   Visibility="{Binding Artist.IsVerified, Converter={StaticResource BoolToVisibilityConverter}}"
                                   Margin="8,0,0,0"/>
                    </StackPanel>
                    <TextBlock Text="{Binding Artist.Name}"
                               Style="{StaticResource HeadingXLarge}"
                               FontSize="64"/>
                    <TextBlock Foreground="{StaticResource TextPrimaryBrush}"
                               FontSize="14" Margin="0,8,0,0">
                        <Run Text="{Binding Artist.MonthlyListenersFormatted, Mode=OneWay}"/>
                        <Run Text=" monthly listeners"/>
                    </TextBlock>
                </StackPanel>
            </Grid>

            <!-- Content -->
            <StackPanel Grid.Row="1" Background="{StaticResource BackgroundSecondaryBrush}">
                <!-- Actions -->
                <StackPanel Orientation="Horizontal" Margin="32,24">
                    <Button Style="{StaticResource LargePlayButtonStyle}"
                            Command="{Binding PlayTopTracksCommand}">
                        <Path Data="{StaticResource PlayIcon}"
                              Fill="{StaticResource BackgroundPrimaryBrush}"
                              Width="24" Height="24" Stretch="Uniform"/>
                    </Button>
                    <Button Style="{StaticResource SecondaryButtonStyle}"
                            Content="{Binding IsFollowing, Converter={StaticResource BoolToFollowTextConverter}}"
                            Command="{Binding ToggleFollowCommand}"
                            Margin="24,0"/>
                </StackPanel>

                <!-- Popular Tracks -->
                <StackPanel Margin="32,0,32,32">
                    <TextBlock Text="Popular"
                               Style="{StaticResource HeadingSmall}"
                               Margin="0,0,0,16"/>
                    <ItemsControl ItemsSource="{Binding TopTracks}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Height="56" Background="Transparent" Cursor="Hand"
                                        Margin="0,0,0,4" CornerRadius="4">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource BackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Border.InputBindings>
                                        <MouseBinding MouseAction="LeftDoubleClick"
                                                      Command="{Binding DataContext.PlayTrackCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                      CommandParameter="{Binding}"/>
                                    </Border.InputBindings>
                                    <Grid Margin="16,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="56"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="60"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0"
                                                   Text="{Binding TrackNumber}"
                                                   Foreground="{StaticResource TextSecondaryBrush}"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center"/>

                                        <Border Grid.Column="1" Width="40" Height="40"
                                                CornerRadius="4"
                                                Background="{StaticResource BackgroundTertiaryBrush}">
                                            <Image Source="{Binding AlbumArtUrl}" Stretch="UniformToFill"/>
                                        </Border>

                                        <TextBlock Grid.Column="2"
                                                   Text="{Binding Title}"
                                                   Foreground="{StaticResource TextPrimaryBrush}"
                                                   VerticalAlignment="Center"
                                                   Margin="12,0"/>

                                        <TextBlock Grid.Column="3"
                                                   Text="{Binding DurationFormatted}"
                                                   Foreground="{StaticResource TextSecondaryBrush}"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Right"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- Discography -->
                <StackPanel Margin="32,0,32,32">
                    <TextBlock Text="Discography"
                               Style="{StaticResource HeadingSmall}"
                               Margin="0,0,0,16"/>
                    <ItemsControl ItemsSource="{Binding Albums}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource CardBackgroundBrush}"
                                        CornerRadius="8" Padding="16" Width="180"
                                        Margin="0,0,16,16" Cursor="Hand">
                                    <Border.InputBindings>
                                        <MouseBinding MouseAction="LeftClick"
                                                      Command="{Binding DataContext.NavigateToAlbumCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                      CommandParameter="{Binding}"/>
                                    </Border.InputBindings>
                                    <StackPanel>
                                        <Border Width="148" Height="148" CornerRadius="4"
                                                Background="{StaticResource BackgroundTertiaryBrush}">
                                            <Image Source="{Binding CoverArtUrl}" Stretch="UniformToFill"/>
                                        </Border>
                                        <TextBlock Text="{Binding Title}"
                                                   Foreground="{StaticResource TextPrimaryBrush}"
                                                   FontWeight="SemiBold" FontSize="14"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,12,0,4"/>
                                        <TextBlock Text="{Binding TypeAndYear}"
                                                   Foreground="{StaticResource TextSecondaryBrush}"
                                                   FontSize="12"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</UserControl>
