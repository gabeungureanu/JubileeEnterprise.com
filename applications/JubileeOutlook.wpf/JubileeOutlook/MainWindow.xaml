<Window x:Class="JubileeOutlook.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:JubileeOutlook"
        xmlns:fluent="urn:fluent-ribbon"
        mc:Ignorable="d"
        Title="Jubilee Outlook"
        Height="900"
        Width="1400"
        MinHeight="300"
        MinWidth="300"
        Background="{StaticResource PrimaryBackgroundBrush}"
        WindowState="Maximized">

    <Grid>
        <Grid.RowDefinitions>
            <!-- Ribbon -->
            <RowDefinition Height="Auto"/>
            <!-- Content Area -->
            <RowDefinition Height="*"/>
            <!-- Status Bar -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Ribbon Control -->
        <fluent:Ribbon Grid.Row="0">

            <!-- HOME TAB -->
            <fluent:RibbonTabItem Header="Home">
                <!-- New Group -->
                <fluent:RibbonGroupBox Header="New">
                    <fluent:Button Header="New"
                                 Command="{Binding NewMessageCommand}"
                                 Size="Large">
                        <fluent:Button.Icon>
                            <TextBlock Text="📝" FontSize="28" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <!-- Delete Group -->
                <fluent:RibbonGroupBox Header="Delete">
                    <fluent:Button Header="Ignore"
                                 Command="{Binding IgnoreMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="✖" FontSize="16" Foreground="#B0B0B0"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Block"
                                 Command="{Binding BlockSenderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⊘" FontSize="16" Foreground="#E57373"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Delete"
                                 Command="{Binding DeleteCommand}"
                                 Size="Large">
                        <fluent:Button.Icon>
                            <TextBlock Text="🗑" FontSize="28" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Archive"
                                 Command="{Binding ArchiveMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📦" FontSize="16" Foreground="#66BB6A"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Report"
                                 Command="{Binding ReportMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⚠" FontSize="16" Foreground="#E57373"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <!-- Respond Group -->
                <fluent:RibbonGroupBox Header="Respond">
                    <fluent:Button Header="Reply"
                                 Command="{Binding ReplyCommand}"
                                 Size="Large">
                        <fluent:Button.Icon>
                            <TextBlock Text="↰" FontSize="28" Foreground="#4A9EFF"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Reply all"
                                 Command="{Binding ReplyAllCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⇚" FontSize="16" Foreground="#4A9EFF" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Forward"
                                 Command="{Binding ForwardCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="→" FontSize="16" Foreground="#4A9EFF" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Meeting"
                                 Command="{Binding CreateMeetingCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📅" FontSize="16" Foreground="#E96D76"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <!-- Move Group -->
                <fluent:RibbonGroupBox Header="Move">
                    <fluent:SplitButton Header="Sweep"
                                      Command="{Binding ArchiveMessageCommand}">
                        <fluent:SplitButton.Icon>
                            <TextBlock Text="♻" FontSize="16" Foreground="#4FC3F7" FontWeight="Bold"/>
                        </fluent:SplitButton.Icon>
                    </fluent:SplitButton>
                    <fluent:Button Header="Move"
                                 Command="{Binding MoveToFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📁" FontSize="16" Foreground="#4FC3F7"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:SplitButton Header="Rules"
                                      Command="{Binding CreateRuleCommand}">
                        <fluent:SplitButton.Icon>
                            <TextBlock Text="📊" FontSize="16" Foreground="#B0B0B0"/>
                        </fluent:SplitButton.Icon>
                    </fluent:SplitButton>
                </fluent:RibbonGroupBox>

                <!-- Quick steps Group -->
                <fluent:RibbonGroupBox Header="Quick steps">
                    <fluent:SplitButton Header="Quick&#xA;steps"
                                      Command="{Binding QuickStepCommand}">
                        <fluent:SplitButton.Icon>
                            <TextBlock Text="⚡" FontSize="16" Foreground="#FFB300"/>
                        </fluent:SplitButton.Icon>
                    </fluent:SplitButton>
                </fluent:RibbonGroupBox>

                <!-- Tags Group -->
                <fluent:RibbonGroupBox Header="Tags">
                    <fluent:Button Header="Read /&#xA;Unread"
                                 Command="{Binding ToggleReadCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="✉" FontSize="16" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:SplitButton Header="Categorize"
                                      Command="{Binding ApplyCategoryCommand}">
                        <fluent:SplitButton.Icon>
                            <TextBlock Text="◆" FontSize="16" Foreground="#CE93D8"/>
                        </fluent:SplitButton.Icon>
                    </fluent:SplitButton>
                    <fluent:SplitButton Header="Flag"
                                      Command="{Binding SetFollowUpCommand}">
                        <fluent:SplitButton.Icon>
                            <TextBlock Text="🚩" FontSize="16" Foreground="#F44336"/>
                        </fluent:SplitButton.Icon>
                    </fluent:SplitButton>
                    <fluent:Button Header="Pin"
                                 Command="{Binding PinMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📌" FontSize="16" Foreground="#4FC3F7"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <!-- Empty Group for spacing -->
                <fluent:RibbonGroupBox Header="">
                    <fluent:Button Header="Snooze"
                                 Command="{Binding SnoozeMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⏰" FontSize="16" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Print"
                                 Command="{Binding PrintMessageCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="🖨" FontSize="16" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="More&#xA;apps"
                                 Command="{Binding MoreAppsCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⊞" FontSize="16" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Discover"
                                 Command="{Binding DiscoverCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⭐" FontSize="16" Foreground="#FFB300"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <!-- Find Group -->
                <fluent:RibbonGroupBox Header="Find">
                    <fluent:Button Header="Find"
                                 Command="{Binding SearchCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="🔍" FontSize="16" Foreground="White"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
            </fluent:RibbonTabItem>

            <!-- SEND/RECEIVE TAB -->
            <fluent:RibbonTabItem Header="Send/Receive">
                <fluent:RibbonGroupBox Header="Send &amp; Receive">
                    <fluent:Button Header="Send/Receive All"
                                 Command="{Binding SendReceiveAllCommand}"
                                 Size="Large">
                        <fluent:Button.Icon>
                            <TextBlock Text="🔄" FontSize="24"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Update Folder"
                                 Command="{Binding UpdateFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="↻" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Download"
                                 Command="{Binding DownloadAddressBookCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⬇" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Preferences">
                    <fluent:Button Header="Work Offline"
                                 Command="{Binding WorkOfflineCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="🔌" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Sync Settings">
                        <fluent:Button.Icon>
                            <TextBlock Text="⚙" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
            </fluent:RibbonTabItem>

            <!-- FOLDER TAB -->
            <fluent:RibbonTabItem Header="Folder">
                <fluent:RibbonGroupBox Header="New">
                    <fluent:Button Header="New Folder"
                                 Command="{Binding NewFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📁" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Actions">
                    <fluent:Button Header="Rename"
                                 Command="{Binding RenameFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="✏" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Delete"
                                 Command="{Binding DeleteFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="✖" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Clean Up"
                                 Command="{Binding CleanUpFolderCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="🧹" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Recover">
                    <fluent:Button Header="Recover Items"
                                 Command="{Binding RecoverDeletedItemsCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="↶" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
            </fluent:RibbonTabItem>

            <!-- VIEW TAB -->
            <fluent:RibbonTabItem Header="View">
                <fluent:RibbonGroupBox Header="Current View">
                    <fluent:Button Header="Mail"
                                 Command="{Binding SwitchToMailViewCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="✉" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Calendar"
                                 Command="{Binding SwitchToCalendarViewCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="📅" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="People">
                        <fluent:Button.Icon>
                            <TextBlock Text="👤" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Tasks">
                        <fluent:Button.Icon>
                            <TextBlock Text="☑" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Layout">
                    <fluent:Button Header="Folder Pane"
                                 Command="{Binding ToggleFolderPaneCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="⬚" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Reading Pane">
                        <fluent:Button.Icon>
                            <TextBlock Text="☰" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                        <fluent:Button.ToolTip>
                            <TextBlock>Change reading pane position (Right/Bottom/Off)</TextBlock>
                        </fluent:Button.ToolTip>
                    </fluent:Button>
                    <fluent:Button Header="To-Do Bar">
                        <fluent:Button.Icon>
                            <TextBlock Text="▢" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Arrangement">
                    <fluent:Button Header="Conversations"
                                 Command="{Binding ToggleConversationViewCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="💬" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Sort By">
                        <fluent:Button.Icon>
                            <TextBlock Text="⇅" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Filter">
                        <fluent:Button.Icon>
                            <TextBlock Text="▼" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>

                <fluent:RibbonGroupBox Header="Window">
                    <fluent:Button Header="Save View"
                                 Command="{Binding SaveCurrentViewCommand}">
                        <fluent:Button.Icon>
                            <TextBlock Text="💾" FontSize="16"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                    <fluent:Button Header="Reset View">
                        <fluent:Button.Icon>
                            <TextBlock Text="↺" FontSize="16" FontWeight="Bold"/>
                        </fluent:Button.Icon>
                    </fluent:Button>
                </fluent:RibbonGroupBox>
            </fluent:RibbonTabItem>
        </fluent:Ribbon>

        <!-- Main Content Area with 3-Pane Layout -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <!-- Left Navigation Pane -->
                <ColumnDefinition Width="250" MinWidth="150"/>
                <ColumnDefinition Width="Auto"/>
                <!-- Middle Message List Pane -->
                <ColumnDefinition Width="400" MinWidth="200"/>
                <ColumnDefinition Width="Auto"/>
                <!-- Right Reading Pane -->
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT PANE: Folder Navigation -->
            <Border Grid.Column="0"
                    Background="{StaticResource SecondaryBackgroundBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,1,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Search Box -->
                    <TextBox Grid.Row="0"
                            Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                            Style="{StaticResource OutlookTextBoxStyle}"
                            Margin="10"
                            Height="32">
                        <TextBox.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding SearchCommand}"/>
                        </TextBox.InputBindings>
                    </TextBox>

                    <!-- Folder List -->
                    <TreeView Grid.Row="1"
                             ItemsSource="{Binding Folders}"
                             Style="{StaticResource OutlookTreeViewStyle}"
                             BorderThickness="0">
                        <TreeView.ItemContainerStyle>
                            <Style TargetType="TreeViewItem" BasedOn="{StaticResource OutlookTreeViewItemStyle}">
                                <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
                            </Style>
                        </TreeView.ItemContainerStyle>
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding SubFolders}">
                                <StackPanel Orientation="Horizontal" Margin="4">
                                    <TextBlock Text="{Binding Icon}" FontSize="14" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding Name}"
                                                                                          FontSize="{StaticResource BodyFontSize}"/>
                                    <TextBlock Text="{Binding UnreadCount, StringFormat='({0})'}"
                                             Foreground="{StaticResource AccentBrush}"
                                             FontWeight="Bold"
                                             FontSize="{StaticResource BodyFontSize}"
                                             Margin="8,0,0,0"
                                             Visibility="{Binding UnreadCount, Converter={StaticResource CountToVisibilityConverter}}"/>
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>
                        <TreeView.Resources>
                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                                           Color="{StaticResource SelectedBackgroundColor}"/>
                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                           Color="{StaticResource SelectedBackgroundColor}"/>
                        </TreeView.Resources>
                    </TreeView>
                </Grid>
            </Border>

            <GridSplitter Grid.Column="1"
                         Width="5"
                         HorizontalAlignment="Stretch"
                         Background="{StaticResource BorderBrush}"/>

            <!-- MIDDLE PANE: Message List -->
            <Border Grid.Column="2"
                    Background="{StaticResource PrimaryBackgroundBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,1,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Folder Header -->
                    <Border Grid.Row="0"
                           Background="{StaticResource TertiaryBackgroundBrush}"
                           BorderBrush="{StaticResource BorderBrush}"
                           BorderThickness="0,0,0,1"
                           Padding="12,8">
                        <TextBlock Text="{Binding SelectedFolder.Name}"
                                                                    FontSize="{StaticResource HeaderFontSize}"
                                  FontWeight="SemiBold"/>
                    </Border>

                    <!-- Message List -->
                    <ListBox Grid.Row="1"
                            ItemsSource="{Binding Messages}"
                            SelectedItem="{Binding SelectedMessage}"
                            Style="{StaticResource OutlookListBoxStyle}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem" BasedOn="{StaticResource OutlookListBoxItemStyle}"/>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{StaticResource BorderBrush}"
                                       BorderThickness="0,0,0,1"
                                       Padding="12,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Sender Name -->
                                        <TextBlock Grid.Row="0" Grid.Column="0"
                                                  Text="{Binding From}"
                                                                                                    FontSize="{StaticResource BodyFontSize}"
                                                  FontWeight="{Binding IsRead, Converter={StaticResource ReadToWeightConverter}}"
                                                  TextTrimming="CharacterEllipsis"/>

                                        <!-- Time -->
                                        <TextBlock Grid.Row="0" Grid.Column="1"
                                                  Text="{Binding ReceivedDate, StringFormat='{}{0:MMM dd}'}"
                                                  Foreground="{StaticResource SecondaryTextBrush}"
                                                  FontSize="{StaticResource SmallFontSize}"
                                                  Margin="8,0,0,0"/>

                                        <!-- Subject -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                                  Text="{Binding Subject}"
                                                                                                    FontSize="{StaticResource BodyFontSize}"
                                                  FontWeight="{Binding IsRead, Converter={StaticResource ReadToWeightConverter}}"
                                                  TextTrimming="CharacterEllipsis"
                                                  Margin="0,4,0,0"/>

                                        <!-- Preview -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                                                  Text="{Binding Preview}"
                                                  Foreground="{StaticResource SecondaryTextBrush}"
                                                  FontSize="{StaticResource SmallFontSize}"
                                                  TextTrimming="CharacterEllipsis"
                                                  Margin="0,4,0,0"/>

                                        <!-- Indicators -->
                                        <StackPanel Grid.Row="0" Grid.Column="0"
                                                   Orientation="Horizontal"
                                                   HorizontalAlignment="Left"
                                                   Margin="0,0,0,0">
                                            <Ellipse Width="8" Height="8"
                                                    Fill="{StaticResource UnreadIndicatorBrush}"
                                                    Margin="0,0,6,0"
                                                    Visibility="{Binding IsRead, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                                            <TextBlock Text="🚩" FontSize="12"
                                                      Visibility="{Binding IsFlagged, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            <TextBlock Text="📎" FontSize="12" Margin="4,0,0,0"
                                                      Visibility="{Binding HasAttachments, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <GridSplitter Grid.Column="3"
                         Width="5"
                         HorizontalAlignment="Stretch"
                         Background="{StaticResource BorderBrush}"/>

            <!-- RIGHT PANE: Reading Pane -->
            <Border Grid.Column="4"
                    Background="{StaticResource PrimaryBackgroundBrush}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Message Header -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="{Binding SelectedMessage.Subject}"
                                                                            FontSize="{StaticResource HeaderFontSize}"
                                      FontWeight="SemiBold"
                                      TextWrapping="Wrap"
                                      Margin="0,0,0,12"/>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0"
                                          Text="From:"
                                          Foreground="{StaticResource SecondaryTextBrush}"
                                          FontSize="{StaticResource BodyFontSize}"
                                          Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                          Text="{Binding SelectedMessage.From}"
                                                                                    FontSize="{StaticResource BodyFontSize}"
                                          Margin="0,0,0,4"/>

                                <TextBlock Grid.Row="1" Grid.Column="0"
                                          Text="To:"
                                          Foreground="{StaticResource SecondaryTextBrush}"
                                          FontSize="{StaticResource BodyFontSize}"
                                          Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="1" Grid.Column="1"
                                          Text="{Binding SelectedMessage.To, Converter={StaticResource ListToStringConverter}}"
                                                                                    FontSize="{StaticResource BodyFontSize}"
                                          TextWrapping="Wrap"
                                          Margin="0,0,0,4"/>

                                <TextBlock Grid.Row="2" Grid.Column="0"
                                          Text="Date:"
                                          Foreground="{StaticResource SecondaryTextBrush}"
                                          FontSize="{StaticResource BodyFontSize}"
                                          Margin="0,0,8,4"/>
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                          Text="{Binding SelectedMessage.ReceivedDate, StringFormat='{}{0:dddd, MMMM dd, yyyy h:mm tt}'}"
                                                                                    FontSize="{StaticResource BodyFontSize}"
                                          Margin="0,0,0,4"/>
                            </Grid>
                        </StackPanel>

                        <Separator Grid.Row="1" Style="{StaticResource OutlookSeparatorStyle}" Margin="0,0,0,20"/>

                        <!-- Message Body -->
                        <TextBlock Grid.Row="2"
                                  Text="{Binding SelectedMessage.Body}"
                                                                    FontSize="{StaticResource BodyFontSize}"
                                  TextWrapping="Wrap"
                                  LineHeight="22"/>
                    </Grid>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2"
               Background="{StaticResource TertiaryBackgroundBrush}"
               BorderBrush="{StaticResource BorderBrush}"
               BorderThickness="0,1,0,0"
               Height="24">
            <Grid Margin="8,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                          Text="{Binding Messages.Count, StringFormat='Items: {0}'}"
                          Foreground="{StaticResource SecondaryTextBrush}"
                          FontSize="{StaticResource SmallFontSize}"
                          VerticalAlignment="Center"/>

                <TextBlock Grid.Column="1"
                          Text="Jubilee Outlook - Connected"
                          Foreground="{StaticResource SecondaryTextBrush}"
                          FontSize="{StaticResource SmallFontSize}"
                          VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</Window>
