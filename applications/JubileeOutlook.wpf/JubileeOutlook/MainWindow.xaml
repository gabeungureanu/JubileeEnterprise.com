<Window x:Class="JubileeOutlook.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:JubileeOutlook"
        xmlns:controls="clr-namespace:JubileeOutlook.Controls"
        xmlns:views="clr-namespace:JubileeOutlook.Views"
        mc:Ignorable="d"
        Title="Jubilee Outlook"
        Height="900"
        Width="1400"
        MinHeight="300"
        MinWidth="300"
        WindowStyle="None"
        ResizeMode="CanResize"
        AllowsTransparency="False"
        Background="{StaticResource PrimaryBackgroundBrush}"
        WindowState="Maximized">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32"
                      ResizeBorderThickness="5"
                      GlassFrameThickness="0"
                      CornerRadius="0"
                      UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <!-- Main Layout: Full-height App Rail on left, rest of content on right, accent bar at bottom -->
    <Grid>
        <Grid.RowDefinitions>
            <!-- Main Content Area -->
            <RowDefinition Height="*"/>
            <!-- Animated Accent Bar -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <!-- Full-height App Rail -->
            <ColumnDefinition Width="48"/>
            <!-- Main Content Area -->
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT APP RAIL: Full height from top to bottom -->
        <controls:AppRailControl Grid.Row="0" Grid.Column="0" DataContext="{Binding AppViewModel}"/>

        <!-- Right side: Title bar, Ribbon, Content, Status Bar -->
        <Grid Grid.Row="0" Grid.Column="1">
            <Grid.RowDefinitions>
                <!-- Title Bar with Tabs -->
                <RowDefinition Height="32"/>
                <!-- Ribbon Content -->
                <RowDefinition Height="Auto"/>
                <!-- Content Area -->
                <RowDefinition Height="*"/>
                <!-- Status Bar -->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Title Bar Row - JubileeVerse Style Header (Black with Dark Gray Active Tab) -->
            <Grid Grid.Row="0" Background="#000000">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Tab Headers (JubileeVerse style with separators) -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0,0,0" WindowChrome.IsHitTestVisibleInChrome="True">
                    <!-- Home Icon -->
                    <TextBlock Text="ðŸ " FontSize="14" Foreground="{StaticResource GoldBrandBrush}" VerticalAlignment="Center" Margin="0,0,4,0" Cursor="Hand"/>
                    <TextBlock Style="{StaticResource RibbonTabSeparatorStyle}"/>
                    <RadioButton x:Name="HomeTab" Content="Home" GroupName="RibbonTabs" Style="{StaticResource RibbonTabButtonStyle}" IsChecked="True" Click="TabButton_Click"/>
                    <TextBlock Style="{StaticResource RibbonTabSeparatorStyle}"/>
                    <RadioButton x:Name="SendReceiveTab" Content="Send/Receive" GroupName="RibbonTabs" Style="{StaticResource RibbonTabButtonStyle}" Click="TabButton_Click"/>
                    <TextBlock Style="{StaticResource RibbonTabSeparatorStyle}"/>
                    <RadioButton x:Name="FolderTab" Content="Folder" GroupName="RibbonTabs" Style="{StaticResource RibbonTabButtonStyle}" Click="TabButton_Click"/>
                    <TextBlock Style="{StaticResource RibbonTabSeparatorStyle}"/>
                    <RadioButton x:Name="ViewTab" Content="View" GroupName="RibbonTabs" Style="{StaticResource RibbonTabButtonStyle}" Click="TabButton_Click"/>
                </StackPanel>

                <!-- Profile Button and Window Control Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" WindowChrome.IsHitTestVisibleInChrome="True">
                    <!-- Profile Button -->
                    <Button x:Name="ProfileButton" Style="{StaticResource ProfileButtonStyle}" Click="ProfileButton_Click" ToolTip="Sign In" Margin="0,0,8,0">
                        <Grid>
                            <!-- Default avatar (silhouette) when signed out -->
                            <Ellipse x:Name="ProfileDefaultAvatar" Width="22" Height="22" Fill="#252545" Visibility="Visible"/>
                            <!-- Person icon -->
                            <Canvas x:Name="ProfileDefaultIcon" Width="12" Height="12" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Visible">
                                <Ellipse x:Name="ProfileIconHead" Width="5" Height="5" Fill="White" Canvas.Left="3.5" Canvas.Top="0"/>
                                <Path x:Name="ProfileIconBody" Fill="White" Data="M 0,12 C 0,8.5 1.7,6.8 6,6.8 C 10.3,6.8 12,8.5 12,12 Z"/>
                            </Canvas>
                            <!-- User avatar when signed in -->
                            <Ellipse x:Name="ProfileUserAvatar" Width="22" Height="22" Stroke="#60a5fa" StrokeThickness="2" Visibility="Collapsed">
                                <Ellipse.Fill>
                                    <ImageBrush x:Name="ProfileAvatarImage" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <!-- Sync indicator dot -->
                            <Ellipse x:Name="ProfileSyncIndicator" Width="7" Height="7" Fill="#22c55e" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,-2,-2" Visibility="Collapsed"/>
                        </Grid>
                    </Button>
                    <Button x:Name="MinimizeButton" Style="{StaticResource WindowButtonStyle}" Click="MinimizeButton_Click" Content="&#xE921;"/>
                    <Button x:Name="MaximizeButton" Style="{StaticResource WindowButtonStyle}" Click="MaximizeButton_Click" Content="&#xE922;"/>
                    <Button x:Name="CloseButton" Style="{StaticResource CloseButtonStyle}" Click="CloseButton_Click" Content="&#xE8BB;"/>
                </StackPanel>
            </Grid>

            <!-- Ribbon Content Panels - Compact Icon-Only Design with Large Icons -->
            <Border Grid.Row="1" Background="{StaticResource RibbonBackgroundBrush}" BorderBrush="{StaticResource RibbonBorderBrush}" BorderThickness="0,1,0,1" Padding="8,6">
                <Grid>
                    <!-- HOME TAB CONTENT - Compact Single Row with Large Icons -->
                    <StackPanel x:Name="HomeTabContent" Orientation="Horizontal" Visibility="Visible" VerticalAlignment="Center">
                        <!-- New Mail Split Button -->
                        <Grid x:Name="NewMailSplitButton" Margin="4,0" Height="29">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Primary Action Button (New Mail) -->
                            <Button x:Name="NewMailPrimaryButton" Grid.Column="0" Click="NewMailPrimaryButton_Click" Height="29">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="{StaticResource GoldBrandBrush}"/>
                                        <Setter Property="Foreground" Value="#000000"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="10,4,8,4"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="border"
                                                            Background="{TemplateBinding Background}"
                                                            Padding="{TemplateBinding Padding}"
                                                            CornerRadius="6,0,0,6">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="{StaticResource GoldBrandHoverBrush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#e5a94d"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{StaticResource IconMail}" FontFamily="{StaticResource MaterialIcons}" FontSize="18" Foreground="#000000" VerticalAlignment="Center"/>
                                    <TextBlock Text="New Mail" FontWeight="Bold" Foreground="#000000" VerticalAlignment="Center" Margin="6,0,0,0"/>
                                </StackPanel>
                            </Button>

                            <!-- Dropdown Trigger Button (Arrow) -->
                            <ToggleButton x:Name="NewDropdownButton" Grid.Column="1" Height="29">
                                <ToggleButton.Style>
                                    <Style TargetType="ToggleButton">
                                        <Setter Property="Background" Value="{StaticResource GoldBrandBrush}"/>
                                        <Setter Property="Foreground" Value="#000000"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="4,4,8,4"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ToggleButton">
                                                    <Border x:Name="border"
                                                            Background="{TemplateBinding Background}"
                                                            Padding="{TemplateBinding Padding}"
                                                            CornerRadius="0,6,6,0">
                                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                            <!-- Separator line -->
                                                            <Rectangle Width="1" Height="16" Fill="#00000040" Margin="0,0,4,0"/>
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="{StaticResource GoldBrandHoverBrush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsPressed" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#e5a94d"/>
                                                        </Trigger>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="border" Property="Background" Value="#e5a94d"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ToggleButton.Style>
                                <TextBlock Text="{StaticResource IconArrowDropDown}" FontFamily="{StaticResource MaterialIcons}" FontSize="16" Foreground="#000000" VerticalAlignment="Center"/>
                            </ToggleButton>

                            <!-- Dropdown Popup -->
                            <Popup x:Name="NewDropdownPopup"
                                   PlacementTarget="{Binding ElementName=NewMailSplitButton}"
                                   Placement="Bottom"
                                   HorizontalOffset="0"
                                   StaysOpen="False"
                                   AllowsTransparency="True"
                                   IsOpen="{Binding IsChecked, ElementName=NewDropdownButton, Mode=TwoWay}">
                                <Border Background="#2b2b2b" BorderBrush="#3a3a3a" BorderThickness="1" CornerRadius="6" Padding="4">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="10" ShadowDepth="3" Opacity="0.5" Color="Black"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <Button x:Name="NewMailMenuItem" Click="NewMailMenuItem_Click" Padding="12,8" MinWidth="150" Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border x:Name="border" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" CornerRadius="4">
                                                                    <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="border" Property="Background" Value="{StaticResource GoldHighlightHoverBrush}"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsPressed" Value="True">
                                                                        <Setter TargetName="border" Property="Background" Value="{StaticResource GoldHighlightBrush}"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </Button.Style>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{StaticResource IconMail}" FontFamily="{StaticResource MaterialIcons}" FontSize="18" Foreground="{StaticResource GoldBrandBrush}" VerticalAlignment="Center"/>
                                                <TextBlock Text="New Mail" Foreground="#FFFFFF" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                            </StackPanel>
                                        </Button>
                                        <Button x:Name="NewMeetingMenuItem" Click="NewMeetingMenuItem_Click" Padding="12,8" MinWidth="150" Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border x:Name="border" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" CornerRadius="4">
                                                                    <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="border" Property="Background" Value="{StaticResource GoldHighlightHoverBrush}"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsPressed" Value="True">
                                                                        <Setter TargetName="border" Property="Background" Value="{StaticResource GoldHighlightBrush}"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </Button.Style>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{StaticResource IconMeeting}" FontFamily="{StaticResource MaterialIcons}" FontSize="18" Foreground="{StaticResource GoldBrandBrush}" VerticalAlignment="Center"/>
                                                <TextBlock Text="New Meeting" Foreground="#FFFFFF" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                            </StackPanel>
                                        </Button>
                                    </StackPanel>
                                </Border>
                            </Popup>
                        </Grid>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Delete (Trash icon) -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.DeleteCommand}" ToolTip="Delete" Margin="4,0">
                            <TextBlock Text="{StaticResource IconTrash}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Archive (Archive box icon) -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ArchiveMessageCommand}" ToolTip="Archive" Margin="4,0">
                            <TextBlock Text="{StaticResource IconArchiveBox}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#66BB6A"/>
                        </Button>

                        <!-- Ignore (Notifications off icon) -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.IgnoreMessageCommand}" ToolTip="Ignore" Margin="4,0">
                            <TextBlock Text="{StaticResource IconIgnore}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#FFAB40"/>
                        </Button>

                        <!-- Block (Block/prohibition icon) -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.BlockSenderCommand}" ToolTip="Block Sender" Margin="4,0">
                            <TextBlock Text="{StaticResource IconBlock}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#E57373"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Reply -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ReplyCommand}" ToolTip="Reply" Margin="4,0">
                            <TextBlock Text="{StaticResource IconReply}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#4A9EFF"/>
                        </Button>

                        <!-- Reply All -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ReplyAllCommand}" ToolTip="Reply All" Margin="4,0">
                            <TextBlock Text="{StaticResource IconReplyAll}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#4A9EFF"/>
                        </Button>

                        <!-- Forward -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ForwardCommand}" ToolTip="Forward" Margin="4,0">
                            <TextBlock Text="{StaticResource IconForward}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#4A9EFF"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Move -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.MoveToFolderCommand}" ToolTip="Move to Folder" Margin="4,0">
                            <TextBlock Text="{StaticResource IconMove}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Read/Unread -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ToggleReadCommand}" ToolTip="Mark Read/Unread" Margin="4,0">
                            <TextBlock Text="{StaticResource IconMail}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Categorize -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ApplyCategoryCommand}" ToolTip="Categorize" Margin="4,0">
                            <TextBlock Text="{StaticResource IconLabel}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#CE93D8"/>
                        </Button>

                        <!-- Flag -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.SetFollowUpCommand}" ToolTip="Flag" Margin="4,0">
                            <TextBlock Text="{StaticResource IconFlag}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#F44336"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Search -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.SearchCommand}" ToolTip="Search" Margin="4,0">
                            <TextBlock Text="{StaticResource IconSearch}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>
                    </StackPanel>

                    <!-- SEND/RECEIVE TAB CONTENT - Compact with Large Icons -->
                    <StackPanel x:Name="SendReceiveTabContent" Orientation="Horizontal" Visibility="Collapsed" VerticalAlignment="Center">
                        <!-- Send/Receive All -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.SendReceiveAllCommand}" ToolTip="Send/Receive All" Margin="4,0">
                            <TextBlock Text="{StaticResource IconSync}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#4FC3F7"/>
                        </Button>

                        <!-- Update Folder -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.UpdateFolderCommand}" ToolTip="Update Folder" Margin="4,0">
                            <TextBlock Text="{StaticResource IconRefresh}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Work Offline -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.WorkOfflineCommand}" ToolTip="Work Offline" Margin="4,0">
                            <TextBlock Text="&#xe1da;" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>
                    </StackPanel>

                    <!-- FOLDER TAB CONTENT - Compact with Large Icons -->
                    <StackPanel x:Name="FolderTabContent" Orientation="Horizontal" Visibility="Collapsed" VerticalAlignment="Center">
                        <!-- New Folder -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.NewFolderCommand}" ToolTip="New Folder" Margin="4,0">
                            <TextBlock Text="{StaticResource IconAdd}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#4FC3F7"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Rename Folder -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.RenameFolderCommand}" ToolTip="Rename Folder" Margin="4,0">
                            <TextBlock Text="{StaticResource IconEdit}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Delete Folder -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.DeleteFolderCommand}" ToolTip="Delete Folder" Margin="4,0">
                            <TextBlock Text="{StaticResource IconTrash}" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#E57373"/>
                        </Button>
                    </StackPanel>

                    <!-- VIEW TAB CONTENT - Compact with Large Icons -->
                    <StackPanel x:Name="ViewTabContent" Orientation="Horizontal" Visibility="Collapsed" VerticalAlignment="Center">
                        <!-- Mail View -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.SwitchToMailViewCommand}" ToolTip="Mail View" Margin="4,0">
                            <TextBlock Text="{StaticResource IconMail}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Calendar View -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.SwitchToCalendarViewCommand}" ToolTip="Calendar View" Margin="4,0">
                            <TextBlock Text="{StaticResource IconCalendar}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Separator -->
                        <Rectangle Width="1" Height="28" Fill="#444444" Margin="8,0"/>

                        <!-- Toggle Folder Pane -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ToggleFolderPaneCommand}" ToolTip="Toggle Folder Pane" Margin="4,0">
                            <TextBlock Text="{StaticResource IconFolder}" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>

                        <!-- Toggle Conversations -->
                        <Button Style="{StaticResource RibbonSmallButtonStyle}" Command="{Binding MainViewModel.ToggleConversationViewCommand}" ToolTip="Conversation View" Margin="4,0">
                            <TextBlock Text="&#xe0b7;" FontFamily="{StaticResource MaterialIcons}" FontSize="24"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content Area with Module Views -->
            <Grid Grid.Row="2">
                <!-- MAIL MODULE VIEW (default) -->
                <Grid x:Name="MailModuleContent" Visibility="Visible">
                    <Grid.ColumnDefinitions>
                        <!-- Folder Navigation -->
                        <ColumnDefinition x:Name="FolderPaneColumn" Width="250" MinWidth="150"/>
                        <ColumnDefinition Width="Auto"/>
                        <!-- Message List -->
                        <ColumnDefinition x:Name="MessageListColumn" Width="400" MinWidth="200"/>
                        <ColumnDefinition Width="Auto"/>
                        <!-- Reading Pane -->
                        <ColumnDefinition Width="*" MinWidth="300"/>
                    </Grid.ColumnDefinitions>

                    <!-- LEFT PANE: Folder Navigation -->
                    <Border Grid.Column="0" Background="{StaticResource SecondaryBackgroundBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Folder Tree -->
                            <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                <StackPanel Margin="0,8,0,0">
                                    <!-- WWBW Account Root Header -->
                                    <Border x:Name="AccountRootHeader" Background="Transparent" Padding="12,8" Cursor="Hand" MouseLeftButtonUp="AccountRootHeader_Click">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Expand/Collapse Toggle -->
                                            <ToggleButton x:Name="FolderExpandToggle"
                                                          Grid.Column="0"
                                                          Style="{StaticResource FolderExpandToggleStyle}"
                                                          IsChecked="{Binding MainViewModel.AccountRootFolder.IsExpanded, Mode=TwoWay}"
                                                          VerticalAlignment="Center"
                                                          Margin="0,0,8,0"/>

                                            <!-- WWBW Email Address (Gold) -->
                                            <TextBlock x:Name="WwbwEmailDisplay"
                                                       Grid.Column="1"
                                                       Text="My Account"
                                                       Foreground="{StaticResource GoldBrandBrush}"
                                                       FontSize="13"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center"
                                                       TextTrimming="CharacterEllipsis"
                                                       ToolTip="My Account"/>
                                        </Grid>
                                    </Border>

                                    <!-- Folder List (collapsible) -->
                                    <ItemsControl x:Name="FolderListPanel"
                                                  ItemsSource="{Binding MainViewModel.AccountRootFolder.SubFolders}"
                                                  Visibility="{Binding MainViewModel.AccountRootFolder.IsExpanded, Converter={StaticResource BoolToVisibilityConverter}}"
                                                  Margin="0,0,0,0">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border x:Name="FolderItemBorder"
                                                        Background="Transparent"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        CornerRadius="0"
                                                        Padding="26,8,10,8"
                                                        Margin="0,1"
                                                        Cursor="Hand"
                                                        MouseLeftButtonUp="FolderItem_Click">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <!-- Folder Icon (Material Icons - Gold) -->
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{Binding Icon}"
                                                                   Style="{StaticResource FolderIconStyle}"/>

                                                        <!-- Folder Name (Roboto Font) -->
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding Name}"
                                                                   FontFamily="{StaticResource AppFontFamily}"
                                                                   Foreground="{StaticResource PrimaryTextBrush}"
                                                                   FontSize="12"
                                                                   VerticalAlignment="Center"
                                                                   TextTrimming="CharacterEllipsis"/>

                                                        <!-- Unread Count Badge -->
                                                        <Border Grid.Column="2"
                                                                Background="{StaticResource AccentBrush}"
                                                                CornerRadius="8"
                                                                Padding="6,2"
                                                                Margin="4,0,0,0"
                                                                Visibility="{Binding UnreadCount, Converter={StaticResource CountToVisibilityConverter}}">
                                                            <TextBlock Text="{Binding UnreadCount}"
                                                                       Foreground="White"
                                                                       FontSize="10"
                                                                       FontWeight="Bold"
                                                                       VerticalAlignment="Center"/>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                <DataTemplate.Triggers>
                                                    <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                        <Setter TargetName="FolderItemBorder" Property="Background" Value="{StaticResource GoldHighlightBrush}"/>
                                                    </DataTrigger>
                                                    <Trigger SourceName="FolderItemBorder" Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="FolderItemBorder" Property="Background" Value="{StaticResource GoldHighlightHoverBrush}"/>
                                                    </Trigger>
                                                </DataTemplate.Triggers>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </ScrollViewer>

                            <!-- Search Box at Bottom -->
                            <Border Grid.Row="1" Background="{StaticResource TertiaryBackgroundBrush}" Padding="8" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
                                <Grid>
                                    <!-- Search Icon (Material Icons) -->
                                    <TextBlock Text="{StaticResource IconSearch}"
                                               FontFamily="{StaticResource MaterialIcons}"
                                               FontSize="16"
                                               Foreground="{StaticResource SecondaryTextBrush}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"
                                               Margin="10,0,0,0"
                                               IsHitTestVisible="False"/>

                                    <!-- Search TextBox -->
                                    <TextBox Text="{Binding MainViewModel.SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource FolderSearchTextBoxStyle}"
                                             Height="32">
                                        <TextBox.InputBindings>
                                            <KeyBinding Key="Enter" Command="{Binding MainViewModel.SearchCommand}"/>
                                        </TextBox.InputBindings>
                                    </TextBox>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>

                    <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="{StaticResource BorderBrush}"/>

                    <!-- MIDDLE PANE: Message List -->
                    <Border Grid.Column="2" Background="{StaticResource PrimaryBackgroundBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="{StaticResource TertiaryBackgroundBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1" Padding="12,8">
                                <TextBlock Text="{Binding MainViewModel.SelectedFolder.Name}" FontSize="{StaticResource HeaderFontSize}" FontWeight="SemiBold" Foreground="{StaticResource GoldBrandBrush}"/>
                            </Border>

                            <ListBox Grid.Row="1" ItemsSource="{Binding MainViewModel.Messages}" SelectedItem="{Binding MainViewModel.SelectedMessage}" Style="{StaticResource OutlookListBoxStyle}" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem" BasedOn="{StaticResource OutlookListBoxItemStyle}"/>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1" Padding="12,8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <!-- Unread Indicator Dot -->
                                                <Ellipse Grid.Row="0" Grid.Column="0" Width="8" Height="8" Fill="{StaticResource UnreadIndicatorBrush}" Margin="0,4,8,0" VerticalAlignment="Top" Visibility="{Binding IsRead, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>

                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding From}" FontSize="{StaticResource BodyFontSize}" FontWeight="{Binding IsRead, Converter={StaticResource ReadToWeightConverter}}" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding ReceivedDate, StringFormat='{}{0:MMM dd}'}" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource SmallFontSize}" Margin="8,0,0,0"/>
                                                <TextBlock Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding Subject}" FontSize="{StaticResource BodyFontSize}" FontWeight="{Binding IsRead, Converter={StaticResource ReadToWeightConverter}}" TextTrimming="CharacterEllipsis" Margin="0,4,0,0"/>
                                                <TextBlock Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding Preview}" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource SmallFontSize}" TextTrimming="CharacterEllipsis" Margin="0,4,0,0"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </Border>

                    <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Background="{StaticResource BorderBrush}"/>

                    <!-- RIGHT PANE: Reading Pane / Compose Panel -->
                    <Border Grid.Column="4" Background="{StaticResource PrimaryBackgroundBrush}">
                        <Grid>
                            <!-- Reading Pane -->
                            <ScrollViewer x:Name="ReadingPane" VerticalScrollBarVisibility="Auto" Visibility="Visible">
                                <Grid Margin="20">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <StackPanel Grid.Row="0" Margin="0,0,0,20">
                                        <TextBlock Text="{Binding MainViewModel.SelectedMessage.Subject}" FontSize="{StaticResource HeaderFontSize}" FontWeight="SemiBold" TextWrapping="Wrap" Margin="0,0,0,12"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="From:" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource BodyFontSize}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding MainViewModel.SelectedMessage.From}" FontSize="{StaticResource BodyFontSize}" Margin="0,0,0,4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="To:" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource BodyFontSize}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding MainViewModel.SelectedMessage.To, Converter={StaticResource ListToStringConverter}}" FontSize="{StaticResource BodyFontSize}" TextWrapping="Wrap" Margin="0,0,0,4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Date:" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource BodyFontSize}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding MainViewModel.SelectedMessage.ReceivedDate, StringFormat='{}{0:dddd, MMMM dd, yyyy h:mm tt}'}" FontSize="{StaticResource BodyFontSize}" Margin="0,0,0,4"/>
                                        </Grid>
                                    </StackPanel>

                                    <Separator Grid.Row="1" Style="{StaticResource OutlookSeparatorStyle}" Margin="0,0,0,20"/>

                                    <!-- Attachments Section -->
                                    <StackPanel Grid.Row="2" Margin="0,0,0,20" Visibility="{Binding MainViewModel.SelectedMessage.Attachments.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                        <TextBlock Text="Attachments:" FontSize="{StaticResource BodyFontSize}" FontWeight="SemiBold" Margin="0,0,0,12"/>
                                        <ItemsControl ItemsSource="{Binding MainViewModel.SelectedMessage.Attachments}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Background="{StaticResource TertiaryBackgroundBrush}"
                                                           BorderBrush="{StaticResource BorderBrush}"
                                                           BorderThickness="1"
                                                           CornerRadius="4"
                                                           Padding="12,8"
                                                           Margin="0,0,0,8"
                                                           Cursor="Hand">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>

                                                            <TextBlock Grid.Column="0"
                                                                      Text="&#xe226;"
                                                                      FontFamily="{StaticResource MaterialIcons}"
                                                                      FontSize="24"
                                                                      Foreground="{StaticResource AccentBrush}"
                                                                      VerticalAlignment="Center"
                                                                      Margin="0,0,12,0"/>

                                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                                <TextBlock Text="{Binding FileName}"
                                                                          FontSize="{StaticResource BodyFontSize}"
                                                                          Foreground="{StaticResource PrimaryTextBrush}"
                                                                          TextTrimming="CharacterEllipsis"/>
                                                                <TextBlock Text="{Binding FileSize}"
                                                                          FontSize="{StaticResource SmallFontSize}"
                                                                          Foreground="{StaticResource SecondaryTextBrush}"
                                                                          Margin="0,2,0,0"/>
                                                            </StackPanel>

                                                            <Button Grid.Column="2"
                                                                   ToolTip="Download"
                                                                   Style="{StaticResource IconButtonStyle}"
                                                                   Margin="8,0,0,0">
                                                                <TextBlock Text="&#xe2c4;"
                                                                          FontFamily="{StaticResource MaterialIcons}"
                                                                          FontSize="20"
                                                                          Foreground="{StaticResource SecondaryTextBrush}"/>
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>

                                    <TextBlock Grid.Row="3" Text="{Binding MainViewModel.SelectedMessage.Body}" FontSize="{StaticResource BodyFontSize}" TextWrapping="Wrap" LineHeight="22"/>
                                </Grid>
                            </ScrollViewer>

                            <!-- Compose Mail Panel -->
                            <views:ComposeMailView x:Name="ComposeMailPanel" Visibility="Collapsed"/>
                        </Grid>
                    </Border>
                </Grid>

                <!-- CALENDAR MODULE VIEW -->
                <Grid x:Name="CalendarModuleContent" Visibility="Collapsed">
                    <views:CalendarView/>
                </Grid>

                <!-- PEOPLE MODULE VIEW -->
                <Grid x:Name="PeopleModuleContent" Visibility="Collapsed">
                    <Border Background="{StaticResource PrimaryBackgroundBrush}">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="&#xE77B;" FontFamily="{StaticResource MaterialIcons}" FontSize="64" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="People" FontSize="24" Foreground="{StaticResource PrimaryTextBrush}" HorizontalAlignment="Center" Margin="0,16,0,0"/>
                            <TextBlock Text="Contacts view coming soon" FontSize="14" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- TASKS MODULE VIEW -->
                <Grid x:Name="TasksModuleContent" Visibility="Collapsed">
                    <Border Background="{StaticResource PrimaryBackgroundBrush}">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="&#xE73A;" FontFamily="{StaticResource MaterialIcons}" FontSize="64" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="Tasks" FontSize="24" Foreground="{StaticResource PrimaryTextBrush}" HorizontalAlignment="Center" Margin="0,16,0,0"/>
                            <TextBlock Text="Tasks view coming soon" FontSize="14" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- APPS MODULE VIEW -->
                <Grid x:Name="AppsModuleContent" Visibility="Collapsed">
                    <Border Background="{StaticResource PrimaryBackgroundBrush}">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <TextBlock Text="&#xE74C;" FontFamily="{StaticResource MaterialIcons}" FontSize="64" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Text="More Apps" FontSize="24" Foreground="{StaticResource PrimaryTextBrush}" HorizontalAlignment="Center" Margin="0,16,0,0"/>
                            <TextBlock Text="Additional apps coming soon" FontSize="14" Foreground="{StaticResource SecondaryTextBrush}" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>

            <!-- Status Bar -->
            <Border Grid.Row="3" Background="{StaticResource TertiaryBackgroundBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0" Height="24">
                <Grid Margin="8,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="{Binding MainViewModel.Messages.Count, StringFormat='Items: {0}'}" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" Text="Jubilee Outlook - Connected" Foreground="{StaticResource SecondaryTextBrush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </Grid>

        <!-- Animated Gold Accent Bar - JubileeVerse Style Wave Animation -->
        <Border x:Name="AccentBarContainer"
                Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                Height="5"
                Background="#444444"
                ClipToBounds="True">
            <!-- Animated gold light sweep using TranslateTransform for smooth GPU-accelerated animation -->
            <Border x:Name="GoldLightSweep"
                    Width="600"
                    Height="5"
                    HorizontalAlignment="Left"
                    RenderTransformOrigin="0.5,0.5">
                <Border.RenderTransform>
                    <TranslateTransform x:Name="GoldLightTransform" X="-600"/>
                </Border.RenderTransform>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                        <GradientStop Color="Transparent" Offset="0"/>
                        <GradientStop Color="#805f3a00" Offset="0.1"/>
                        <GradientStop Color="#f0ad4e" Offset="0.3"/>
                        <GradientStop Color="#ffcc00" Offset="0.5"/>
                        <GradientStop Color="#f0ad4e" Offset="0.7"/>
                        <GradientStop Color="#805f3a00" Offset="0.9"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
        </Border>

        <!-- Profile Popup -->
        <Popup x:Name="ProfilePopup"
               PlacementTarget="{Binding ElementName=ProfileButton}"
               Placement="Bottom"
               HorizontalOffset="-130"
               VerticalOffset="4"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="None">
            <Border x:Name="ProfilePopupBorder"
                    Background="#1e1e2e"
                    BorderBrush="#3a3a5e"
                    BorderThickness="1"
                    CornerRadius="12"
                    Width="300">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.4" Color="Black"/>
                </Border.Effect>
                <StackPanel>
                    <!-- Signed Out State -->
                    <StackPanel x:Name="ProfileSignedOutPanel" Visibility="Visible" Margin="20">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Grid Width="48" Height="48" Margin="0,0,16,0">
                                <Ellipse Fill="#3a3a5e"/>
                                <TextBlock Text="&#xE77B;" FontFamily="{StaticResource MaterialIcons}" FontSize="24" Foreground="#888888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Sign in to sync your data" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <TextBlock Text="Access your data across devices" FontSize="12" Foreground="#E6AC00" Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>
                        <Button x:Name="ProfileSignInButton" Click="ProfileSignIn_Click" Background="#E6AC00" Margin="0,0,0,8" Padding="16,10" Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                            <TextBlock Text="Sign In" FontWeight="Bold" FontSize="14" Foreground="Black"/>
                        </Button>
                        <TextBlock Text="Sign in with your Jubilee account to sync bookmarks, history, passwords, and settings across all your devices. Don't have an account? You can create one during sign-in."
                                   TextWrapping="Wrap" FontSize="11" Foreground="White" Margin="0,8,0,0" TextAlignment="Justify"/>
                    </StackPanel>

                    <!-- Signed In State -->
                    <StackPanel x:Name="ProfileSignedInPanel" Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal" Margin="20,20,20,8">
                            <Ellipse x:Name="ProfilePopupAvatar" Width="48" Height="48" Margin="0,0,16,0">
                                <Ellipse.Fill>
                                    <ImageBrush x:Name="ProfilePopupAvatarImage" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <StackPanel VerticalAlignment="Center" MaxWidth="200">
                                <TextBlock x:Name="ProfilePopupName" Text="User Name" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <TextBlock x:Name="ProfilePopupEmail" Text="user@example.com" FontSize="12" Foreground="White" Margin="0,2,0,0"/>
                                <TextBlock Text="Signed in to your Jubilee account" FontSize="10" Foreground="#22c55e" Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Sync Status -->
                        <Border Background="#1a3a1a" CornerRadius="6" Margin="16,8,16,12" Padding="12,10">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE895;" FontFamily="{StaticResource MaterialIcons}" FontSize="16" Foreground="#22c55e" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <StackPanel>
                                    <TextBlock Text="Syncing is on" FontSize="12" FontWeight="SemiBold" Foreground="#22c55e"/>
                                    <TextBlock Text="Your data is synced" FontSize="10" Foreground="#606060" Margin="0,2,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Menu Items -->
                        <Border BorderBrush="#3a3a5e" BorderThickness="0,1,0,0" Margin="16,0,16,0"/>
                        <StackPanel Margin="8,8,8,16">
                            <Button x:Name="ProfileManageAccountButton" Click="ProfileManageAccount_Click" Style="{StaticResource ProfileMenuItemStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE77B;" FontFamily="{StaticResource MaterialIcons}" FontSize="16" Foreground="#CCCCCC" VerticalAlignment="Center" Width="24"/>
                                    <TextBlock Text="Manage Account" FontSize="13" Foreground="White" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="ProfileSignOutButton" Click="ProfileSignOut_Click" Style="{StaticResource ProfileMenuItemStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE8BB;" FontFamily="{StaticResource MaterialIcons}" FontSize="16" Foreground="#CCCCCC" VerticalAlignment="Center" Width="24"/>
                                    <TextBlock Text="Sign Out" FontSize="13" Foreground="White" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>
